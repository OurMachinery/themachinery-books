<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Animation Compression - The Machinery Book</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="../../favicon.svg">
                        <link rel="shortcut icon" href="../../favicon.png">
                <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
                <link rel="stylesheet" href="../../css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../index.html"><strong aria-hidden="true">1.</strong> Welcome</a></li><li class="chapter-item expanded "><a href="../../what_is_the_machinery.html"><strong aria-hidden="true">2.</strong> What is The Machinery</a></li><li class="chapter-item expanded "><a href="../../licenses.html"><strong aria-hidden="true">3.</strong> Licenses</a></li><li class="chapter-item expanded "><a href="../../getting_started/index.html"><strong aria-hidden="true">4.</strong> Getting Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../getting_started/what_is_in_the_package.html"><strong aria-hidden="true">4.1.</strong> What is in this package</a></li><li class="chapter-item expanded "><a href="../../getting_started/logging_in.html"><strong aria-hidden="true">4.2.</strong> Sign In</a></li><li class="chapter-item expanded "><a href="../../getting_started/new_project.html"><strong aria-hidden="true">4.3.</strong> New Project</a></li><li class="chapter-item expanded "><a href="../../getting_started/first_gameplay_project.html"><strong aria-hidden="true">4.4.</strong> First Gameplay Project</a></li><li class="chapter-item expanded "><a href="../../getting_started/sample-projects.html"><strong aria-hidden="true">4.5.</strong> Sample Projects</a></li><li class="chapter-item expanded "><a href="../../getting_started/troubleshooting.html"><strong aria-hidden="true">4.6.</strong> Troubleshooting</a></li><li class="chapter-item expanded "><a href="../../getting_started/migration_from_unity.html"><strong aria-hidden="true">4.7.</strong> The Machinery for Unity Dev's</a></li><li class="chapter-item expanded "><a href="../../getting_started/migration_from_unreal.html"><strong aria-hidden="true">4.8.</strong> The Machinery for Unreal 4 Dev's</a></li></ol></li><li class="chapter-item expanded "><a href="../../the_editor/index.html"><strong aria-hidden="true">5.</strong> The Editor</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../the_editor/tabs.html"><strong aria-hidden="true">5.1.</strong> About Tabs</a></li><li class="chapter-item expanded "><a href="../../the_editor/entity_tree_tab.html"><strong aria-hidden="true">5.2.</strong> Entity Tree Tab</a></li><li class="chapter-item expanded "><a href="../../the_editor/scene_tab.html"><strong aria-hidden="true">5.3.</strong> Scene Tab</a></li><li class="chapter-item expanded "><a href="../../the_editor/properties_tab.html"><strong aria-hidden="true">5.4.</strong> Properties Tab</a></li><li class="chapter-item expanded "><a href="../../the_editor/asset_browser.html"><strong aria-hidden="true">5.5.</strong> Asset Browser</a></li><li class="chapter-item expanded "><a href="../../the_editor/simulate_tab.html"><strong aria-hidden="true">5.6.</strong> Simulate Tab</a></li><li class="chapter-item expanded "><a href="../../the_editor/preview_tab.html"><strong aria-hidden="true">5.7.</strong> Preview Tab</a></li></ol></li><li class="chapter-item expanded "><a href="../../editing_workflows/index.html"><strong aria-hidden="true">6.</strong> Editing Workflows</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../editing_workflows/entities.html"><strong aria-hidden="true">6.1.</strong> Entities</a></li><li class="chapter-item expanded "><a href="../../editing_workflows/creation_graphs_asset_pipeline.html"><strong aria-hidden="true">6.2.</strong> Creation graphs and asset pipeline</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../editing_workflows/import_assets.html"><strong aria-hidden="true">6.2.1.</strong> Import Assets</a></li><li class="chapter-item expanded "><a href="../../editing_workflows/import_projects.html"><strong aria-hidden="true">6.2.2.</strong> Import Projects</a></li></ol></li><li class="chapter-item expanded "><a href="../../editing_workflows/prototypes.html"><strong aria-hidden="true">6.3.</strong> Prototypes</a></li><li class="chapter-item expanded "><a href="../../editing_workflows/simulation.html"><strong aria-hidden="true">6.4.</strong> Simulation</a></li><li class="chapter-item expanded "><a href="../../editing_workflows/visual-scripting.html"><strong aria-hidden="true">6.5.</strong> Visual Scripting: Entity Graphs</a></li><li class="chapter-item expanded "><a href="../../editing_workflows/physics.html"><strong aria-hidden="true">6.6.</strong> Physics</a></li><li class="chapter-item expanded "><a href="../../editing_workflows/animation/index.html"><strong aria-hidden="true">6.7.</strong> Animation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../editing_workflows/animation/animation-state-machine.html"><strong aria-hidden="true">6.7.1.</strong> Animation State Machines</a></li><li class="chapter-item expanded "><a href="../../editing_workflows/animation/animation-compression.html" class="active"><strong aria-hidden="true">6.7.2.</strong> Animation Compression</a></li></ol></li><li class="chapter-item expanded "><a href="../../editing_workflows/sound.html"><strong aria-hidden="true">6.8.</strong> Sound</a></li><li class="chapter-item expanded "><a href="../../editing_workflows/publish.html"><strong aria-hidden="true">6.9.</strong> Publish</a></li><li class="chapter-item expanded "><a href="../../editing_workflows/sculpting.html"><strong aria-hidden="true">6.10.</strong> Sculpt Tool / White boxing</a></li></ol></li><li class="chapter-item expanded "><a href="../../the_truth/index.html"><strong aria-hidden="true">7.</strong> The Truth</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../the_truth/access_values.html"><strong aria-hidden="true">7.1.</strong> Access values</a></li><li class="chapter-item expanded "><a href="../../the_truth/create_an_object.html"><strong aria-hidden="true">7.2.</strong> Create an object</a></li><li class="chapter-item expanded "><a href="../../the_truth/modify_an_object.html"><strong aria-hidden="true">7.3.</strong> Modify an object</a></li><li class="chapter-item expanded "><a href="../../the_truth/common_types.html"><strong aria-hidden="true">7.4.</strong> Common Types</a></li><li class="chapter-item expanded "><a href="../../the_truth/aspects.html"><strong aria-hidden="true">7.5.</strong> Aspects</a></li><li class="chapter-item expanded "><a href="../../the_truth/custom_truth_type.html"><strong aria-hidden="true">7.6.</strong> Create a Truth Type</a></li></ol></li><li class="chapter-item expanded "><a href="../../creation_graphs/concept.html"><strong aria-hidden="true">8.</strong> Creation Graphs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../creation_graphs/intro_unity.html"><strong aria-hidden="true">8.1.</strong> Creation Graphs for Untiy Dev's</a></li><li class="chapter-item expanded "><a href="../../creation_graphs/intro_unreal.html"><strong aria-hidden="true">8.2.</strong> Creation Graphs for Unreal 4 Dev's</a></li><li class="chapter-item expanded "><a href="../../creation_graphs/node_types.html"><strong aria-hidden="true">8.3.</strong> Node Types</a></li></ol></li><li class="chapter-item expanded "><a href="../../extending_the_machinery/index.html"><strong aria-hidden="true">9.</strong> Extending The Machinery</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../extending_the_machinery/the_plugin_system.html"><strong aria-hidden="true">9.1.</strong> The Plugin System</a></li><li class="chapter-item expanded "><a href="../../extending_the_machinery/hot-reloading.html"><strong aria-hidden="true">9.2.</strong> Hot-reloading</a></li><li class="chapter-item expanded "><a href="../../extending_the_machinery/plugin-assets.html"><strong aria-hidden="true">9.3.</strong> Plugin assets</a></li><li class="chapter-item expanded "><a href="../../extending_the_machinery/write-a-plugin.html"><strong aria-hidden="true">9.4.</strong> Write a plugin</a></li><li class="chapter-item expanded "><a href="../../extending_the_machinery/write-a-tab.html"><strong aria-hidden="true">9.5.</strong> Write a tab</a></li></ol></li><li class="chapter-item expanded "><a href="../../gameplay_coding/index.html"><strong aria-hidden="true">10.</strong> Gameplay coding</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../gameplay_coding/simulate_entry.html"><strong aria-hidden="true">10.1.</strong> Simulate Entry in C</a></li><li class="chapter-item expanded "><a href="../../gameplay_coding/extend_the_visual_scripting_language.html"><strong aria-hidden="true">10.2.</strong> Extending the visual scripting language</a></li><li class="chapter-item expanded "><a href="../../gameplay_coding/ecs/index.html"><strong aria-hidden="true">10.3.</strong> Entity Component System</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../gameplay_coding/ecs/write_a_custom_component.html"><strong aria-hidden="true">10.3.1.</strong> Write a custom component</a></li><li class="chapter-item expanded "><a href="../../gameplay_coding/ecs/write_a_system_or_engine.html"><strong aria-hidden="true">10.3.2.</strong> Write a Systems &amp; Engines</a></li></ol></li><li class="chapter-item expanded "><a href="../../helper_tools/tmbuild.html"><strong aria-hidden="true">10.4.</strong> How to build my plugin</a></li></ol></li><li class="chapter-item expanded "><a href="../../collaboration.html"><strong aria-hidden="true">11.</strong> Collaboration</a></li><li class="chapter-item expanded "><a href="../../qa_pipeline/index.html"><strong aria-hidden="true">12.</strong> QA Pipeline</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../qa_pipeline/how_to_write_unit_tests.html"><strong aria-hidden="true">12.1.</strong> Write your own unit tests</a></li><li class="chapter-item expanded "><a href="../../qa_pipeline/how_to_write_integration_tests.html"><strong aria-hidden="true">12.2.</strong> Write your own integration tests</a></li></ol></li><li class="chapter-item expanded "><a href="../../helper_tools/index.html"><strong aria-hidden="true">13.</strong> Helper Tools</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../helper_tools/tmbuild.html"><strong aria-hidden="true">13.1.</strong> How to use tmbuild</a></li><li class="chapter-item expanded "><a href="../../helper_tools/hash.html"><strong aria-hidden="true">13.2.</strong> How to use hash</a></li><li class="chapter-item expanded "><a href="../../helper_tools/tmbuild_package_reference.html"><strong aria-hidden="true">13.3.</strong> tmbuild package reference</a></li></ol></li><li class="chapter-item expanded "><a href="../../writing_an_executable.html"><strong aria-hidden="true">14.</strong> Writing an executable</a></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">The Machinery Book</h1>

                    <div class="right-buttons">
                                                <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        <a href="https://github.com/OurMachinery/themachinery-books" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                                                
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="animation-compression"><a class="header" href="#animation-compression">Animation Compression</a></h2>
<p>We support compressed animations. Compressed animations have the extension <code>.animation</code>. Note that with this, we have three kinds of animation resources:</p>
<table><thead><tr><th><strong>Resource</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td><code>.dcc_asset</code></td><td>Animation imported from a Digital Content Creation (DCC) software, such as Max, Maya, Blender, etc. Note  that <code>.dcc_asset</code> is used for all imported content, so it could be animations, textures, models, etc.</td></tr>
<tr><td><code>.animation</code></td><td>A compressed animation. The compressed animation is generated from the <code>.dcc_asset</code> by explicitly compressing it.</td></tr>
<tr><td><code>.animation_clip</code></td><td>Specifies how an animation should be played: playback speed, whether it plays forward or backward, if it drives the root bone or not, etc.<br><br>An <em>Animation Clip</em> references either an uncompressed <code>.dcc_asset</code> or a compressed <code>.animation</code> to access the actual animation data.</td></tr>
</tbody></table>
<p>To create a compressed animation, right-click a <code>.dcc_asset</code> file that contains an animation and choose <strong>Create xxx.animation</strong> in the context menu:</p>
<p><img src="https://paper-attachments.dropbox.com/s_AF44CABDD4BF19FA7D54C2D4574B155CAAE2ED895AFB490AC3671972A5F81DC2_1617123138052_image.png" alt="A compressed animation." /></p>
<p>When you first do this, the animation shows a white skeleton in T-pose and a moving blue skeleton. The blue skeleton is the reference <code>.dcc_animation</code> and the white skeleton is the compressed animation. By comparing the skeletons you can see how big the error in the animation is.</p>
<p>At first, the white skeleton is in T-pose because we haven’t actually generated the compressed data yet. To do that, press the <strong>Compress</strong> button:</p>
<p><img src="https://paper-attachments.dropbox.com/s_AF44CABDD4BF19FA7D54C2D4574B155CAAE2ED895AFB490AC3671972A5F81DC2_1617123319435_image.png" alt="Compressed animation with data." /></p>
<p>This will update the <strong>Format</strong> and <strong>Buffer</strong> fields and we can see that we have 9.2 KB of compressed data for this animation and that the compression ratio is x 6.66. I.e, the compressed data is 6.66 times smaller than the uncompressed one. The white and the blue skeletons overlap. The compression error is too small to be noticed in this view, we have to really zoom in to see it:</p>
<p><img src="https://paper-attachments.dropbox.com/s_AF44CABDD4BF19FA7D54C2D4574B155CAAE2ED895AFB490AC3671972A5F81DC2_1617123494752_image.png" alt="Zoomed in view of one of the fingers." /></p>
<p>When you compress an animation like this, The Machinery tries to come up with some good default compression settings. The default settings work in a lot of cases, but they’re not perfect,
because The Machinery can’t know how the animation is intended to be viewed in your game.</p>
<p>Are you making a miniature fighting game, and all the models will be viewed from a distant overhead camera? In that case, you can get away with a lot of compression. Or are you animating a gun sight that will be held up really close to the player’s eye? In that case, a small error will be very visible.</p>
<p>To help the engine, you can create an <code>.animation_compression</code> asset. (<strong>New Animation Compression</strong> in the asset browser.) The Animation Compression asset control the settings for all the animations in the same folder or in its subfolders (unless the subfolders override with a local Animation Compression asset):</p>
<p><img src="https://paper-attachments.dropbox.com/s_AF44CABDD4BF19FA7D54C2D4574B155CAAE2ED895AFB490AC3671972A5F81DC2_1617124020292_image.png" alt="Animation Compression settings." /></p>
<p>The Animation Compression settings object has two properties:</p>
<p><strong>Max Error</strong> specifies the maximum allowed error in the compressed animation. The default value is 0.001 or 1 mm. This means that when we do the compression we allow bones to be off by 1 mm, but not more. The lower you set this value, the less compression you will get.</p>
<p><strong>Skin Size</strong> specifies the size we assume for the character’s skin. It defaults to 0.1, or 10 cm. We need the skin size to estimate the effects of rotational errors. For example, if the rotation of a bone is off by 1°, the effect of that in mm depends on how far away from the bone the mesh is.</p>
<p>10 cm is a reasonable approximation for a human character, but notice that there are situations where the skin size can be significantly larger. For example, suppose that a 3 m long staff is attached to the player’s hand bone. In this case, rotational errors in the hand are amplified by the full length of the staff and can lead to really big errors in the position of the staff end. If this gives you trouble, you might want to up the skin size to 3 for animations with the staff.</p>
<p>We don’t support setting a per-bone skin size, because it’s unclear if the effort of specifying per-bone skin sizes is really worth it in terms of the memory savings it can give. (Also, even a per-bone skin size might not be enough to estimate errors perfectly. For example, an animator could have set up a miter joint where the extent of the skin depends on the relative angle of two bones and goes to infinity as the angle approaches zero.)</p>
<p>Note that sometimes animations are exported in other units than meters. In this case, the Skin Size and the Max Error should be specified in the same units that are used in the animation file.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="../../editing_workflows/animation/animation-state-machine.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="../../editing_workflows/sound.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="../../editing_workflows/animation/animation-state-machine.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="../../editing_workflows/sound.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
