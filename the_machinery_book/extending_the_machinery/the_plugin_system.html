<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The Plugin System - The Machinery Book</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="../favicon.svg">
                        <link rel="shortcut icon" href="../favicon.png">
                <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
                <link rel="stylesheet" href="../css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="../index.html"><strong aria-hidden="true">1.</strong> Welcome</a></li><li class="chapter-item "><a href="../what_is_the_machinery.html"><strong aria-hidden="true">2.</strong> What is The Machinery</a></li><li class="chapter-item "><a href="../licenses.html"><strong aria-hidden="true">3.</strong> Licenses</a></li><li class="chapter-item "><a href="../glossary.html"><strong aria-hidden="true">4.</strong> Glossary</a></li><li class="chapter-item "><a href="../troubleshooting.html"><strong aria-hidden="true">5.</strong> Troubleshooting</a></li><li class="chapter-item "><a href="../getting_started/index.html"><strong aria-hidden="true">6.</strong> Getting Started</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../getting_started/what_is_in_the_package.html"><strong aria-hidden="true">6.1.</strong> What is in this package</a></li><li class="chapter-item "><a href="../getting_started/logging_in.html"><strong aria-hidden="true">6.2.</strong> Sign In</a></li><li class="chapter-item "><a href="../getting_started/project_setup.html"><strong aria-hidden="true">6.3.</strong> Project Setup</a></li><li class="chapter-item "><a href="../getting_started/new_project.html"><strong aria-hidden="true">6.4.</strong> New Project</a></li><li class="chapter-item "><a href="../getting_started/first_gameplay_project.html"><strong aria-hidden="true">6.5.</strong> First Gameplay Project</a></li><li class="chapter-item "><a href="../getting_started/sample-projects.html"><strong aria-hidden="true">6.6.</strong> Sample Projects</a></li><li class="chapter-item "><a href="../getting_started/migration_from_unity.html"><strong aria-hidden="true">6.7.</strong> The Machinery for Unity Dev's</a></li><li class="chapter-item "><a href="../getting_started/migration_from_unreal.html"><strong aria-hidden="true">6.8.</strong> The Machinery for Unreal 4 Dev's</a></li><li class="chapter-item "><a href="../getting_started/migration_from_godot.html"><strong aria-hidden="true">6.9.</strong> The Machinery for Godot Dev's</a></li><li class="chapter-item "><a href="../getting_started/introduction_to_c.html"><strong aria-hidden="true">6.10.</strong> Introduction to C</a></li></ol></li><li class="chapter-item "><a href="../the_editor/index.html"><strong aria-hidden="true">7.</strong> The Editor</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../the_editor/tabs.html"><strong aria-hidden="true">7.1.</strong> About Tabs</a></li><li class="chapter-item "><a href="../the_editor/entity_tree_tab.html"><strong aria-hidden="true">7.2.</strong> Entity Tree Tab</a></li><li class="chapter-item "><a href="../the_editor/scene_tab.html"><strong aria-hidden="true">7.3.</strong> Scene Tab</a></li><li class="chapter-item "><a href="../the_editor/properties_tab.html"><strong aria-hidden="true">7.4.</strong> Properties Tab</a></li><li class="chapter-item "><a href="../the_editor/asset_browser.html"><strong aria-hidden="true">7.5.</strong> Asset Browser</a></li><li class="chapter-item "><a href="../the_editor/simulate_tab.html"><strong aria-hidden="true">7.6.</strong> Simulate Tab</a></li><li class="chapter-item "><a href="../the_editor/preview_tab.html"><strong aria-hidden="true">7.7.</strong> Preview Tab</a></li><li class="chapter-item "><a href="../the_editor/customizations.html"><strong aria-hidden="true">7.8.</strong> Customizations</a></li></ol></li><li class="chapter-item "><a href="../editing_workflows/index.html"><strong aria-hidden="true">8.</strong> Editing Workflows</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../editing_workflows/entities.html"><strong aria-hidden="true">8.1.</strong> Entities</a></li><li class="chapter-item "><a href="../editing_workflows/import_assets.html"><strong aria-hidden="true">8.2.</strong> Import Assets</a></li><li class="chapter-item "><a href="../editing_workflows/import_projects.html"><strong aria-hidden="true">8.3.</strong> Import Projects</a></li><li class="chapter-item "><a href="../editing_workflows/asset_pipeline.html"><strong aria-hidden="true">8.4.</strong> Asset pipeline by Example</a></li><li class="chapter-item "><a href="../editing_workflows/shaders_materials.html"><strong aria-hidden="true">8.5.</strong> Meshes / Materials / Shaders</a></li><li class="chapter-item "><a href="../editing_workflows/prototypes.html"><strong aria-hidden="true">8.6.</strong> Prototypes</a></li><li class="chapter-item "><a href="../editing_workflows/simulation.html"><strong aria-hidden="true">8.7.</strong> Simulation</a></li><li class="chapter-item "><a href="../editing_workflows/visual-scripting.html"><strong aria-hidden="true">8.8.</strong> Visual Scripting: Entity Graphs</a></li><li class="chapter-item "><a href="../editing_workflows/physics.html"><strong aria-hidden="true">8.9.</strong> Physics</a></li><li class="chapter-item "><a href="../editing_workflows/animation/index.html"><strong aria-hidden="true">8.10.</strong> Animation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../editing_workflows/animation/animation-state-machine.html"><strong aria-hidden="true">8.10.1.</strong> Animation State Machines</a></li><li class="chapter-item "><a href="../editing_workflows/animation/animation-compression.html"><strong aria-hidden="true">8.10.2.</strong> Animation Compression</a></li></ol></li><li class="chapter-item "><a href="../editing_workflows/sound.html"><strong aria-hidden="true">8.11.</strong> Sound</a></li><li class="chapter-item "><a href="../editing_workflows/publish.html"><strong aria-hidden="true">8.12.</strong> Publish</a></li><li class="chapter-item "><a href="../editing_workflows/sculpting.html"><strong aria-hidden="true">8.13.</strong> Sculpt Tool / White boxing</a></li></ol></li><li class="chapter-item "><a href="../the_truth/index.html"><strong aria-hidden="true">9.</strong> The Truth</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../the_truth/access_values.html"><strong aria-hidden="true">9.1.</strong> Access values</a></li><li class="chapter-item "><a href="../the_truth/create_an_object.html"><strong aria-hidden="true">9.2.</strong> Create an object</a></li><li class="chapter-item "><a href="../the_truth/modify_an_object.html"><strong aria-hidden="true">9.3.</strong> Modify an object</a></li><li class="chapter-item "><a href="../the_truth/common_types.html"><strong aria-hidden="true">9.4.</strong> Common Types</a></li><li class="chapter-item "><a href="../the_truth/aspects.html"><strong aria-hidden="true">9.5.</strong> Aspects</a></li><li class="chapter-item "><a href="../the_truth/custom_truth_type.html"><strong aria-hidden="true">9.6.</strong> Create a Truth Type</a></li></ol></li><li class="chapter-item "><a href="../creation_graphs/concept.html"><strong aria-hidden="true">10.</strong> Creation Graphs</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../creation_graphs/intro_unity.html"><strong aria-hidden="true">10.1.</strong> Creation Graphs for Untiy Dev's</a></li><li class="chapter-item "><a href="../creation_graphs/intro_unreal.html"><strong aria-hidden="true">10.2.</strong> Creation Graphs for Unreal 4 Dev's</a></li><li class="chapter-item "><a href="../creation_graphs/node_types.html"><strong aria-hidden="true">10.3.</strong> Node Types</a></li><li class="chapter-item "><a href="../creation_graphs/shader_system.html"><strong aria-hidden="true">10.4.</strong> Shader System Interaction</a></li></ol></li><li class="chapter-item "><a href="../graphics/index.html"><strong aria-hidden="true">11.</strong> Graphics</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../graphics/camera.html"><strong aria-hidden="true">11.1.</strong> Camera</a></li><li class="chapter-item "><a href="../graphics/physical_light_and_camera.html"><strong aria-hidden="true">11.2.</strong> Physically Based Light and Cameras</a></li><li class="chapter-item "><a href="../graphics/default_render_pipeline.html"><strong aria-hidden="true">11.3.</strong> Default Render Pipeline</a></li><li class="chapter-item "><a href="../graphics/mesh_materials.html"><strong aria-hidden="true">11.4.</strong> Meshes / Materials</a></li><li class="chapter-item "><a href="../graphics/shaders.html"><strong aria-hidden="true">11.5.</strong> Shaders</a></li><li class="chapter-item "><a href="../graphics/the_machinery_shading_language.html"><strong aria-hidden="true">11.6.</strong> The Machinery Shading Language</a></li><li class="chapter-item "><a href="../graphics/tmsl_vs.html"><strong aria-hidden="true">11.7.</strong> .tmsl Visual Studio Extension</a></li></ol></li><li class="chapter-item expanded "><a href="../extending_the_machinery/index.html"><strong aria-hidden="true">12.</strong> Extending The Machinery</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../extending_the_machinery/the_plugin_system.html" class="active"><strong aria-hidden="true">12.1.</strong> The Plugin System</a></li><li class="chapter-item "><a href="../extending_the_machinery/hot-reloading.html"><strong aria-hidden="true">12.2.</strong> Hot-reloading</a></li><li class="chapter-item "><a href="../extending_the_machinery/write-a-plugin.html"><strong aria-hidden="true">12.3.</strong> Write a plugin</a></li><li class="chapter-item "><a href="../extending_the_machinery/write-a-tab.html"><strong aria-hidden="true">12.4.</strong> Write a tab</a></li><li class="chapter-item "><a href="../extending_the_machinery/plugin-assets.html"><strong aria-hidden="true">12.5.</strong> Plugin assets</a></li><li class="chapter-item "><a href="../extending_the_machinery/application_hooks.html"><strong aria-hidden="true">12.6.</strong> Application Hooks</a></li></ol></li><li class="chapter-item "><a href="../gameplay_coding/index.html"><strong aria-hidden="true">13.</strong> Gameplay coding</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../gameplay_coding/simulation_entry.html"><strong aria-hidden="true">13.1.</strong> Simulation Entry in C</a></li><li class="chapter-item "><a href="../gameplay_coding/visual_scripting/index.html"><strong aria-hidden="true">13.2.</strong> Visual Scripting</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../gameplay_coding/visual_scripting/subgraphs.html"><strong aria-hidden="true">13.2.1.</strong> Subgraphs</a></li><li class="chapter-item "><a href="../gameplay_coding/visual_scripting/debugger.html"><strong aria-hidden="true">13.2.2.</strong> Debugger</a></li></ol></li><li class="chapter-item "><a href="../gameplay_coding/ecs/index.html"><strong aria-hidden="true">13.3.</strong> Entity Component System</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../gameplay_coding/ecs/what_are_components.html"><strong aria-hidden="true">13.3.1.</strong> What are components</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/how_entites_can_interact.html"><strong aria-hidden="true">13.3.2.</strong> How can Entities Interact?</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/how_to_design_system_or_engine.html"><strong aria-hidden="true">13.3.3.</strong> How to design a System or an Engine?</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/how_to_define_a_engine_system.html"><strong aria-hidden="true">13.3.4.</strong> How to define a System or an Engine?</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/how_to_register_a_system_or_engine.html"><strong aria-hidden="true">13.3.5.</strong> How to register a System or an Engine?</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/write_a_custom_component.html"><strong aria-hidden="true">13.3.6.</strong> Write a custom component</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/tagging_entities.html"><strong aria-hidden="true">13.3.7.</strong> Tagging Entities</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/filtering_entities.html"><strong aria-hidden="true">13.3.8.</strong> Filtering Entities</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/simulation_lifecycle.html"><strong aria-hidden="true">13.3.9.</strong> Simulation Lifecycle</a></li></ol></li><li class="chapter-item "><a href="../gameplay_coding/gameplay_entry_comparison.html"><strong aria-hidden="true">13.4.</strong> Gameplay Entry Point Comparison</a></li></ol></li><li class="chapter-item "><a href="../collaboration.html"><strong aria-hidden="true">14.</strong> Collaboration</a></li><li class="chapter-item "><a href="../qa_pipeline/index.html"><strong aria-hidden="true">15.</strong> QA Pipeline</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../qa_pipeline/statistics.html"><strong aria-hidden="true">15.1.</strong> Statistics Tab</a></li><li class="chapter-item "><a href="../qa_pipeline/profiler.html"><strong aria-hidden="true">15.2.</strong> Profiler Tab</a></li><li class="chapter-item "><a href="../qa_pipeline/memory.html"><strong aria-hidden="true">15.3.</strong> Memory Usage Tab</a></li><li class="chapter-item "><a href="../qa_pipeline/logging.html"><strong aria-hidden="true">15.4.</strong> Logging</a></li><li class="chapter-item "><a href="../qa_pipeline/how_to_write_unit_tests.html"><strong aria-hidden="true">15.5.</strong> Write your own unit tests</a></li><li class="chapter-item "><a href="../qa_pipeline/how_to_write_integration_tests.html"><strong aria-hidden="true">15.6.</strong> Write your own integration tests</a></li></ol></li><li class="chapter-item "><a href="../helper_tools/index.html"><strong aria-hidden="true">16.</strong> Helper Tools</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../helper_tools/tmbuild.html"><strong aria-hidden="true">16.1.</strong> How to use tmbuild</a></li><li class="chapter-item "><a href="../helper_tools/hash.html"><strong aria-hidden="true">16.2.</strong> How to use hash</a></li><li class="chapter-item "><a href="../helper_tools/tmbuild_package_reference.html"><strong aria-hidden="true">16.3.</strong> tmbuild package reference</a></li></ol></li><li class="chapter-item "><a href="../writing_an_executable.html"><strong aria-hidden="true">17.</strong> Writing an executable</a></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">The Machinery Book</h1>

                    <div class="right-buttons">
                                                <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        <a href="https://github.com/OurMachinery/themachinery-books" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                                                
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="the-plugin-system"><a class="header" href="#the-plugin-system">The plugin system</a></h1>
<p><em>The Machinery</em> is built around a plugin model. All features, even the built-in ones, are provided through plugins. You can extend <em>The Machinery</em> by writing your own plugins.</p>
<p>When <em>The Machinery</em> launches, it loads all the plugins named <code>tm_*.dll</code> in its <code>plugins/</code> folder. If you write your own plugins, name them so that they start with <code>tm_</code> and put them in this folder, they will be loaded together with the built-in plugins.</p>
<p><strong>Table of Content</strong></p>
<ul>
<li><a href="#about-apis">About API's</a></li>
<li><a href="#about-interfaces">About Interfaces</a>
<ul>
<li><a href="#contributors">Contributors</a></li>
</ul>
</li>
</ul>
<h2 id="about-apis"><a class="header" href="#about-apis">About API's</a></h2>
<p><em>The Machinery</em> is organized into individual APIs that can be called to perform specific tasks. A
plugin is a DLL that exposes one or several of these APIs. In order to implement its functionality,
the plugin may in turn rely on APIs exposed by other plugins.</p>
<p>A central object called the <em>API registry</em> is used to keep track of all the APIs. When you want to
use an API from another plugin, you ask the API registry for it. Similarly, you expose your APIs to
the world by registering them with the API registry.</p>
<p>This may seem a bit abstract at this point, so let’s look at a concrete example, <a href="https://ourmachinery.com/apidoc/foundation/unicode.h.html#unicode.h">unicode.h</a> which
exposes an API for encoding and decoding Unicode strings:</p>
<pre><code class="language-c">#pragma once

#include &quot;api_types.h&quot;

struct tm_temp_allocator_i;

// API for converting between UTF-8 encoded text and UTF-16 or UTF-32. All strings in The Machinery
// are UTF-8 encoded, but UTF-16 and UTF-32 are sometimes needed to communicate with external APIs.
// For example, Windows uses UTF-16.
//
// !!! TODO: API-REVIEW
//     * Add `tm_str_t codepoint_range(tm_str_t s)`.

struct tm_unicode_api
{
    // UTF-8

    // Returns *true* if `utf8` is a valid UTF-8 string, *false* otherwise.
    bool (*is_valid)(const char *utf8);

    // Fixes the truncation of a UTF-8 encoded string `utf-8` by replacing any split codepoints at
    // the end of the string with `\0` bytes. You can use this after truncating a string to make
    // sure that the resulting string is still a valid UTF-8 string.
    void (*truncate)(char *utf8);

    // UTF-32

    // Encodes the `codepoint` as UTF-8 into `utf8` and returns a pointer to the position where
    // to insert the next codepoint. `utf8` should have room for at least four bytes (the
    // maximum size of a UTF-8 encoded codepoint).
    char *(*utf8_encode)(char *utf8, uint32_t codepoint);

    // Decodes and returns the first codepoint in the UTF-8 string `utf8`. The string pointer is
    // advanced to point to the next codepoint in the string. Will generate an error message
    // if the string is not a UTF-8 string.
    uint32_t (*utf8_decode)(const char **utf8);

    // Returns the number of codepoints in `utf8`.
    uint32_t (*utf8_num_codepoints)(const char *utf8);

    // Decodes the first `n` codepoints in `utf8` to the `codepoints` buffer. If `utf8`
    // contains fewer than `n` codepoints -- decodes as many codepoints there are in `utf8`.
    // Returns the number of decoded codepoints.
    uint32_t (*utf8_decode_n)(uint32_t *codepoints, uint32_t n, const char *utf8);

    // Converts a UTF-8 encoded string to a UTF-32 encoded one, allocated with the supplied
    // temp allocator. Will generate an error message if the string is not a UTF-8 string.
    uint32_t *(*utf8_to_utf32)(const char *utf8, struct tm_temp_allocator_i *ta);

    // As [[utf8_to_utf32()]], but uses an explicit length instead of a zero terminated string. Note
    // that the result string will still be zero terminated.
    uint32_t *(*utf8_to_utf32_n)(const char *utf8, uint32_t n, struct tm_temp_allocator_i *ta);

    // Converts a UTF-32 encoded string to a UTF-8 encoded one, allocated with the specified temp
    // allocator. Generates an error if the data is outside the UTF-8 encoding range.
    char *(*utf32_to_utf8)(const uint32_t *utf32, struct tm_temp_allocator_i *ta);

    // As [[utf32_to_utf8()]], but uses an explicit length instead of a zero terminated string. Note
    // that the result string will still be zero terminated.
    char *(*utf32_to_utf8_n)(const uint32_t *utf32, uint32_t n, struct tm_temp_allocator_i *ta);

    // UTF-16

    // Encodes the codepoint as UTF-16 into `utf16` and returns a pointer to the position where to
    // insert the next codepoint. `utf16` should have at room for at least two `uint16_t` (the
    // maximum size of a UTF-16 encoded codepoint).
    uint16_t *(*utf16_encode)(uint16_t *utf16, uint32_t codepoint);

    // Decodes and returns the first codepoint in the UTF-16 string `utf16`. The string pointer is
    // advanced to point to the next codepoint in the string.
    uint32_t (*utf16_decode)(const uint16_t **utf16);

    // Converts a UTF-8 encoded string to a UTF-16 encoded one, allocated with the supplied temp
    // allocator. Will generate an error message if the data is outside the UTF-8 encoding range.
    uint16_t *(*utf8_to_utf16)(const char *utf8, struct tm_temp_allocator_i *ta);

    // As [[utf8_to_utf16()]] but uses an explicit length instead of a zero terminated string. Note
    // that the result string will still be zero terminated.
    uint16_t *(*utf8_to_utf16_n)(const char *utf8, uint32_t n, struct tm_temp_allocator_i *ta);

    // Converts a UTF-16 encoded string to a UTF-8 encoded one, allocated with the specified
    // temp allocator. Will generate an error message if the string is not a UTF-16 string.
    char *(*utf16_to_utf8)(const uint16_t *utf16, struct tm_temp_allocator_i *ta);

    // As [[utf16_to_utf8()]] but uses an explicit length instead of a zero terminated string. Note
    // that the result string will still be zero terminated.
    char *(*utf16_to_utf8_n)(const uint16_t *utf16, uint32_t n, struct tm_temp_allocator_i *ta);
};

#define tm_unicode_api_version TM_VERSION(1, 0, 0)

// Returns a UTF-8 string representing the codepoint `cp`. The string is stack allocated.
#define tm_codepoint_to_utf8(cp) tm_codepoint_to_utf8_internal(cp, (char[5]){ 0 })

#if defined(TM_LINKS_FOUNDATION)
extern struct tm_unicode_api *tm_unicode_api;
#endif
</code></pre>
<p>Let’s go through this.</p>
<p>First, the code includes <code>&lt;api_types.h&gt;</code>. This is a shared header with common type declarations, it
includes things like <code>&lt;stdbool.h&gt;</code> and <code>&lt;stdint.h&gt;</code> and also defines a few <em>The Machinery</em> specific
types, such as <code>tm_vec3_t</code>.</p>
<p>In <em>The Machinery</em> we have a rule that header files can't include other header files (except
for <code>&lt;api_types.h&gt;</code>). This helps keep compile times down, but it also simplifies the structure of the
code. When you read a header file you don’t have to follow a long chain of other header files to understand
what is happening.</p>
<p>Next follows a block of forward struct declarations (in this case only one).</p>
<p>Next, we have the name of this API defined as a constant <a href="https://ourmachinery.com/apidoc/foundation/unicode.h.html#structtm_unicode_api">tm_unicode_api</a>, followed by the
<code>struct tm_unicode_api</code> that defines the functions in the API.</p>
<p>To use this API, you would first use the API registry to query for the API pointer, then using that
pointer, call the functions of the API:</p>
<pre><code class="language-c">static struct tm_unicode_api *tm_unicode_api;
#include &lt;foundation/api_registry.h&gt;
#include &lt;foundation/unicode.h&gt;

static void demo_usage(char *utf8, uint32_t codepoint) {
  tm_unicode_api-&gt;utf8_encode(utf8, codepoint);
  // more code...
}

TM_DLL_EXPORT void tm_load_plugin(struct tm_api_registry_api *reg, bool load) {
  tm_unicode_api = tm_get_api(reg, tm_unicode_api);
}
</code></pre>
<p>The different APIs that you can query for and use are documented in their respective header files,
and in the <code>apidoc.md.html</code> documentation file (which is just extracted from the headers). Consult
these files for information on how to use the various APIs that are available in <em>The Machinery.</em></p>
<p>In addition to APIs defined in header files, <em>The Machinery</em> also contains some header files with
inline functions that you can include directly into your implementation files. For example
<code>&lt;math.inl&gt;</code> provides common mathematical operations on vectors and matrices, while <code>&lt;carray.inl&gt;</code>
provides a “stretchy-buffer” implementation (i.e. a C version of C++’s <code>std::vector</code>).</p>
<h2 id="about-interfaces"><a class="header" href="#about-interfaces">About Interfaces</a></h2>
<p>We also add an <em>implementation</em> of the unit test <em>interface</em> to the registry. The API registry has
support for both APIs and interfaces. The difference is that APIs only have a single implementation,
whereas interfaces can have many implementations. For example, all code that can be unit-tested
implements the unit test interface. Unit test programs can query the API registry to find all these
implementations and run all the unit tests.</p>
<p>To extend the editor you add implementations to the interfaces used by the editor. For example, you
can add implementations of the <a href="https://ourmachinery.com/apidoc/foundation/the_truth.h.html#tm_the_truth_create_types_i">tm_the_truth_create_types_i</a>  in order to create new
data types in The Truth, and add implementations of the <a href="https://ourmachinery.com/apidoc/plugins/entity/entity.h.html#tm_entity_create_component_i">tm_entity_create_component_i</a>
in order to define new entity components. See the sample plugin examples.</p>
<p>It does not matter in which order the plugins are loaded. If you query for a plugin that hasn’t yet
been registered, you get a pointer to a nulled struct back. When the plugin is loaded, that struct
is filled in with the actual function pointers. As long as you don’t <em>call</em> the functions before the
plugin that implements them has been loaded, you are good. (You can test this by checking for NULL
pointers in the struct.)</p>
<h3 id="contributors"><a class="header" href="#contributors">Contributors</a></h3>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="../extending_the_machinery/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="../extending_the_machinery/hot-reloading.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="../extending_the_machinery/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="../extending_the_machinery/hot-reloading.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
