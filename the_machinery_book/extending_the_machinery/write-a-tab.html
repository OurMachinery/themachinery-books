<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Write a tab - The Machinery Book</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="../index.html"><strong aria-hidden="true">1.</strong> Welcome</a></li><li class="chapter-item "><a href="../what_is_the_machinery.html"><strong aria-hidden="true">2.</strong> What is The Machinery</a></li><li class="chapter-item "><a href="../licenses.html"><strong aria-hidden="true">3.</strong> Licenses</a></li><li class="chapter-item "><a href="../faq.html"><strong aria-hidden="true">4.</strong> FAQ</a></li><li class="chapter-item "><a href="../glossary.html"><strong aria-hidden="true">5.</strong> Glossary</a></li><li class="chapter-item "><a href="../troubleshooting.html"><strong aria-hidden="true">6.</strong> Troubleshooting</a></li><li class="chapter-item "><a href="../contributing.html"><strong aria-hidden="true">7.</strong> Contribution</a></li><li class="chapter-item "><a href="../getting_started/index.html"><strong aria-hidden="true">8.</strong> Getting Started</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../getting_started/what_is_in_the_package.html"><strong aria-hidden="true">8.1.</strong> What is in this package</a></li><li class="chapter-item "><a href="../getting_started/logging_in.html"><strong aria-hidden="true">8.2.</strong> Sign In</a></li><li class="chapter-item "><a href="../getting_started/project_setup.html"><strong aria-hidden="true">8.3.</strong> Project Setup</a></li><li class="chapter-item "><a href="../getting_started/version_control.html"><strong aria-hidden="true">8.4.</strong> Version Control</a></li><li class="chapter-item "><a href="../getting_started/new_project.html"><strong aria-hidden="true">8.5.</strong> New Project</a></li><li class="chapter-item "><a href="../getting_started/first_gameplay_project.html"><strong aria-hidden="true">8.6.</strong> First Gameplay Project</a></li><li class="chapter-item "><a href="../getting_started/sample-projects.html"><strong aria-hidden="true">8.7.</strong> Sample Projects</a></li><li class="chapter-item "><a href="../getting_started/migration_from_unity.html"><strong aria-hidden="true">8.8.</strong> The Machinery for Unity Dev's</a></li><li class="chapter-item "><a href="../getting_started/migration_from_unreal.html"><strong aria-hidden="true">8.9.</strong> The Machinery for Unreal 4 Dev's</a></li><li class="chapter-item "><a href="../getting_started/migration_from_godot.html"><strong aria-hidden="true">8.10.</strong> The Machinery for Godot Dev's</a></li><li class="chapter-item "><a href="../getting_started/introduction_to_c.html"><strong aria-hidden="true">8.11.</strong> Introduction to C</a></li></ol></li><li class="chapter-item "><a href="../the_editor/index.html"><strong aria-hidden="true">9.</strong> The Editor</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../the_editor/tabs.html"><strong aria-hidden="true">9.1.</strong> About Tabs</a></li><li class="chapter-item "><a href="../the_editor/entity_tree_tab.html"><strong aria-hidden="true">9.2.</strong> Entity Tree Tab</a></li><li class="chapter-item "><a href="../the_editor/scene_tab.html"><strong aria-hidden="true">9.3.</strong> Scene Tab</a></li><li class="chapter-item "><a href="../the_editor/properties_tab.html"><strong aria-hidden="true">9.4.</strong> Properties Tab</a></li><li class="chapter-item "><a href="../the_editor/asset_browser.html"><strong aria-hidden="true">9.5.</strong> Asset Browser</a></li><li class="chapter-item "><a href="../the_editor/simulate_tab.html"><strong aria-hidden="true">9.6.</strong> Simulate Tab</a></li><li class="chapter-item "><a href="../the_editor/preview_tab.html"><strong aria-hidden="true">9.7.</strong> Preview Tab</a></li><li class="chapter-item "><a href="../the_editor/customizations.html"><strong aria-hidden="true">9.8.</strong> Customizations</a></li></ol></li><li class="chapter-item "><a href="../editing_workflows/index.html"><strong aria-hidden="true">10.</strong> Editing Workflows</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../editing_workflows/entities.html"><strong aria-hidden="true">10.1.</strong> Entities</a></li><li class="chapter-item "><a href="../editing_workflows/import_assets.html"><strong aria-hidden="true">10.2.</strong> Import Assets</a></li><li class="chapter-item "><a href="../editing_workflows/import_projects.html"><strong aria-hidden="true">10.3.</strong> Import Projects</a></li><li class="chapter-item "><a href="../editing_workflows/asset_pipeline.html"><strong aria-hidden="true">10.4.</strong> Asset pipeline by Example</a></li><li class="chapter-item "><a href="../editing_workflows/shaders_materials.html"><strong aria-hidden="true">10.5.</strong> Meshes / Materials / Shaders</a></li><li class="chapter-item "><a href="../editing_workflows/prototypes.html"><strong aria-hidden="true">10.6.</strong> Prototypes</a></li><li class="chapter-item "><a href="../editing_workflows/simulation.html"><strong aria-hidden="true">10.7.</strong> Simulation</a></li><li class="chapter-item "><a href="../editing_workflows/visual-scripting.html"><strong aria-hidden="true">10.8.</strong> Visual Scripting: Entity Graphs</a></li><li class="chapter-item "><a href="../editing_workflows/physics.html"><strong aria-hidden="true">10.9.</strong> Physics</a></li><li class="chapter-item "><a href="../editing_workflows/animation/index.html"><strong aria-hidden="true">10.10.</strong> Animation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../editing_workflows/animation/animation-state-machine.html"><strong aria-hidden="true">10.10.1.</strong> Animation State Machines</a></li><li class="chapter-item "><a href="../editing_workflows/animation/animation-compression.html"><strong aria-hidden="true">10.10.2.</strong> Animation Compression</a></li></ol></li><li class="chapter-item "><a href="../editing_workflows/sound.html"><strong aria-hidden="true">10.11.</strong> Sound</a></li><li class="chapter-item "><a href="../editing_workflows/publish.html"><strong aria-hidden="true">10.12.</strong> Publish</a></li><li class="chapter-item "><a href="../editing_workflows/sculpting.html"><strong aria-hidden="true">10.13.</strong> Sculpt Tool / White boxing</a></li></ol></li><li class="chapter-item "><a href="../the_truth/index.html"><strong aria-hidden="true">11.</strong> The Truth</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../the_truth/access_values.html"><strong aria-hidden="true">11.1.</strong> Access values</a></li><li class="chapter-item "><a href="../the_truth/create_an_object.html"><strong aria-hidden="true">11.2.</strong> Create an object</a></li><li class="chapter-item "><a href="../the_truth/modify_an_object.html"><strong aria-hidden="true">11.3.</strong> Modify an object</a></li><li class="chapter-item "><a href="../the_truth/common_types.html"><strong aria-hidden="true">11.4.</strong> Common Types</a></li><li class="chapter-item "><a href="../the_truth/aspects.html"><strong aria-hidden="true">11.5.</strong> Aspects</a></li><li class="chapter-item "><a href="../the_truth/custom_truth_type.html"><strong aria-hidden="true">11.6.</strong> Create a Truth Type</a></li></ol></li><li class="chapter-item "><a href="../creation_graphs/concept.html"><strong aria-hidden="true">12.</strong> Creation Graphs</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../creation_graphs/intro_unity.html"><strong aria-hidden="true">12.1.</strong> Creation Graphs for Untiy Dev's</a></li><li class="chapter-item "><a href="../creation_graphs/intro_unreal.html"><strong aria-hidden="true">12.2.</strong> Creation Graphs for Unreal 4 Dev's</a></li><li class="chapter-item "><a href="../creation_graphs/node_types.html"><strong aria-hidden="true">12.3.</strong> Node Types</a></li><li class="chapter-item "><a href="../creation_graphs/shader_system.html"><strong aria-hidden="true">12.4.</strong> Shader System Interaction</a></li></ol></li><li class="chapter-item "><a href="../graphics/index.html"><strong aria-hidden="true">13.</strong> Graphics</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../graphics/camera.html"><strong aria-hidden="true">13.1.</strong> Camera</a></li><li class="chapter-item "><a href="../graphics/physical_light_and_camera.html"><strong aria-hidden="true">13.2.</strong> Physically Based Light and Cameras</a></li><li class="chapter-item "><a href="../graphics/default_render_pipeline.html"><strong aria-hidden="true">13.3.</strong> Default Render Pipeline</a></li><li class="chapter-item "><a href="../graphics/mesh_materials.html"><strong aria-hidden="true">13.4.</strong> Meshes / Materials</a></li><li class="chapter-item "><a href="../graphics/shaders.html"><strong aria-hidden="true">13.5.</strong> Shaders</a></li><li class="chapter-item "><a href="../graphics/the_machinery_shading_language.html"><strong aria-hidden="true">13.6.</strong> The Machinery Shading Language</a></li><li class="chapter-item "><a href="../graphics/tmsl_vs.html"><strong aria-hidden="true">13.7.</strong> .tmsl Visual Studio Extension</a></li></ol></li><li class="chapter-item expanded "><a href="../extending_the_machinery/index.html"><strong aria-hidden="true">14.</strong> Extending The Machinery</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../extending_the_machinery/the_plugin_system.html"><strong aria-hidden="true">14.1.</strong> The Plugin System</a></li><li class="chapter-item "><a href="../extending_the_machinery/hot-reloading.html"><strong aria-hidden="true">14.2.</strong> Hot-reloading</a></li><li class="chapter-item "><a href="../extending_the_machinery/write-a-plugin.html"><strong aria-hidden="true">14.3.</strong> Write a plugin</a></li><li class="chapter-item expanded "><a href="../extending_the_machinery/write-a-tab.html" class="active"><strong aria-hidden="true">14.4.</strong> Write a tab</a></li><li class="chapter-item "><a href="../extending_the_machinery/plugin-assets.html"><strong aria-hidden="true">14.5.</strong> Plugin assets</a></li><li class="chapter-item "><a href="../extending_the_machinery/application_hooks.html"><strong aria-hidden="true">14.6.</strong> Application Hooks</a></li><li class="chapter-item "><a href="../extending_the_machinery/premake.html"><strong aria-hidden="true">14.7.</strong> Premake</a></li></ol></li><li class="chapter-item "><a href="../gameplay_coding/index.html"><strong aria-hidden="true">15.</strong> Gameplay coding</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../gameplay_coding/simulation_entry.html"><strong aria-hidden="true">15.1.</strong> Simulation Entry in C</a></li><li class="chapter-item "><a href="../gameplay_coding/visual_scripting/index.html"><strong aria-hidden="true">15.2.</strong> Visual Scripting</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../gameplay_coding/visual_scripting/subgraphs.html"><strong aria-hidden="true">15.2.1.</strong> Subgraphs</a></li><li class="chapter-item "><a href="../gameplay_coding/visual_scripting/debugger.html"><strong aria-hidden="true">15.2.2.</strong> Debugger</a></li></ol></li><li class="chapter-item "><a href="../gameplay_coding/ecs/index.html"><strong aria-hidden="true">15.3.</strong> Entity Component System</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../gameplay_coding/ecs/what_are_components.html"><strong aria-hidden="true">15.3.1.</strong> What are components</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/how_entites_can_interact.html"><strong aria-hidden="true">15.3.2.</strong> How can Entities Interact?</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/how_to_design_system_or_engine.html"><strong aria-hidden="true">15.3.3.</strong> How to design a System or an Engine?</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/how_to_define_a_engine_system.html"><strong aria-hidden="true">15.3.4.</strong> How to define a System or an Engine?</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/how_to_register_a_system_or_engine.html"><strong aria-hidden="true">15.3.5.</strong> How to register a System or an Engine?</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/write_a_custom_component.html"><strong aria-hidden="true">15.3.6.</strong> Write a custom component</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/tagging_entities.html"><strong aria-hidden="true">15.3.7.</strong> Tagging Entities</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/filtering_entities.html"><strong aria-hidden="true">15.3.8.</strong> Filtering Entities</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/simulation_lifecycle.html"><strong aria-hidden="true">15.3.9.</strong> Simulation Lifecycle</a></li></ol></li><li class="chapter-item "><a href="../gameplay_coding/gameplay_entry_comparison.html"><strong aria-hidden="true">15.4.</strong> Gameplay Entry Point Comparison</a></li></ol></li><li class="chapter-item "><a href="../collaboration.html"><strong aria-hidden="true">16.</strong> Collaboration</a></li><li class="chapter-item "><a href="../qa_pipeline/index.html"><strong aria-hidden="true">17.</strong> QA Pipeline</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../qa_pipeline/statistics.html"><strong aria-hidden="true">17.1.</strong> Statistics Tab</a></li><li class="chapter-item "><a href="../qa_pipeline/profiler.html"><strong aria-hidden="true">17.2.</strong> Profiler Tab</a></li><li class="chapter-item "><a href="../qa_pipeline/memory.html"><strong aria-hidden="true">17.3.</strong> Memory Usage Tab</a></li><li class="chapter-item "><a href="../qa_pipeline/logging.html"><strong aria-hidden="true">17.4.</strong> Logging</a></li><li class="chapter-item "><a href="../qa_pipeline/how_to_write_unit_tests.html"><strong aria-hidden="true">17.5.</strong> Write your own unit tests</a></li><li class="chapter-item "><a href="../qa_pipeline/how_to_write_integration_tests.html"><strong aria-hidden="true">17.6.</strong> Write your own integration tests</a></li></ol></li><li class="chapter-item "><a href="../helper_tools/index.html"><strong aria-hidden="true">18.</strong> Helper Tools</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../helper_tools/tmbuild.html"><strong aria-hidden="true">18.1.</strong> How to use tmbuild</a></li><li class="chapter-item "><a href="../helper_tools/hash.html"><strong aria-hidden="true">18.2.</strong> How to use hash</a></li><li class="chapter-item "><a href="../helper_tools/tmbuild_package_reference.html"><strong aria-hidden="true">18.3.</strong> tmbuild package reference</a></li></ol></li><li class="chapter-item "><a href="../writing_an_executable.html"><strong aria-hidden="true">19.</strong> Writing an executable</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Machinery Book</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/OurMachinery/themachinery-books" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="write-a-tab"><a class="header" href="#write-a-tab">Write a Tab</a></h1>
<p>This walkthrough shows you how to add a custom Tab to the Engine.</p>
<p>During this walkthrough, we will cover the following topics:</p>
<ul>
<li>How to create a tab from scratch.</li>
<li>Where and how do we register the Tab to the Engine.</li>
</ul>
<p>You should have basic knowledge about how to write a custom plugin. If not, you might want to check this <a href="https://ourmachinery.github.io/themachinery-books/the_machinery_book/extending_the_machinery/the_plugin_system.html">Guide</a> and the <a href="https://ourmachinery.github.io/themachinery-books/the_machinery_book/extending_the_machinery/write-a-plugin.html#build-requirements">Write a plugin guide</a>. The goal of this walkthrough is to dissect the Tab plugin provided by the Engine.</p>
<h2 id="where-do-we-start"><a class="header" href="#where-do-we-start">Where do we start?</a></h2>
<p>In this example, we want to create a new plugin, which contains our Tab. We open the Engine go to <strong>file -&gt; New Plugin -&gt; Editor Tab.</strong> The file dialog will pop up and ask us where we want to save our file. Pick a location that suits you.</p>
<blockquote>
<p><strong>Tip:</strong> Maybe store your plugin in a folder next to your game project.</p>
</blockquote>
<p>After this, we see that the Engine created some files for us.</p>
<p><img src="https://www.dropbox.com/s/jhrqv8t8bbhr20u/tm_tut_new_tab.png?dl=1" alt="folder structure new plugin" /></p>
<p>Now we need to ensure that we can build our project. In the root folder (The folder with the premake file), we can run <code>tmbuild</code> and see if there is no issue. We will build our projects once and generate the <code>.sln</code> file (on windows). </p>
<p>If there is an issue, we should ensure we have set up the Environment variables correctly and installed all the needed dependencies. For more information, please read this <a href="https://ourmachinery.github.io/themachinery-books/the_machinery_book/helper_tools/tmbuild.html">guide</a>.</p>
<p>Now we can open the <code>.c</code> file with our favorite IDE. The file will contain the following content:</p>
<pre><code class="language-c">static struct tm_api_registry_api *tm_global_api_registry;

static struct tm_draw2d_api *tm_draw2d_api;
static struct tm_ui_api *tm_ui_api;
static struct tm_allocator_api *tm_allocator_api;

#include &lt;foundation/allocator.h&gt;
#include &lt;foundation/api_registry.h&gt;

#include &lt;plugins/ui/docking.h&gt;
#include &lt;plugins/ui/draw2d.h&gt;
#include &lt;plugins/ui/ui.h&gt;
#include &lt;plugins/ui/ui_custom.h&gt;

#include &lt;the_machinery/the_machinery_tab.h&gt;

#include &lt;stdio.h&gt;
#define TM_CUSTOM_TAB_VT_NAME &quot;tm_custom_tab&quot;
#define TM_CUSTOM_TAB_VT_NAME_HASH TM_STATIC_HASH(&quot;tm_custom_tab&quot;, 0xbc4e3e47fbf1cdc1ULL)
struct tm_tab_o
{
    tm_tab_i tm_tab_i;
    tm_allocator_i allocator;
};
static void tab__ui(tm_tab_o *tab, tm_ui_o *ui, const tm_ui_style_t *uistyle_in, tm_rect_t rect)
{
    tm_ui_buffers_t uib = tm_ui_api-&gt;buffers(ui);
    tm_ui_style_t *uistyle = (tm_ui_style_t[]){*uistyle_in};
    tm_draw2d_style_t *style = &amp;(tm_draw2d_style_t){0};
    tm_ui_api-&gt;to_draw_style(ui, style, uistyle);
    style-&gt;color = (tm_color_srgb_t){.a = 255, .r = 255};
    tm_draw2d_api-&gt;fill_rect(uib.vbuffer, *uib.ibuffers, style, rect);
}
static const char *tab__create_menu_name(void)
{
    return &quot;Custom Tab&quot;;
}

static const char *tab__title(tm_tab_o *tab, struct tm_ui_o *ui)
{
    return &quot;Custom Tab&quot;;
}
static tm_tab_vt *custom_tab_vt;

static tm_tab_i *tab__create(tm_tab_create_context_t *context, tm_ui_o *ui)
{
    tm_allocator_i allocator = tm_allocator_api-&gt;create_child(context-&gt;allocator, &quot;Custom Tab&quot;);
    uint64_t *id = context-&gt;id;
    tm_tab_o *tab = tm_alloc(&amp;allocator, sizeof(tm_tab_o));
    *tab = (tm_tab_o){
        .tm_tab_i = {
            .vt = custom_tab_vt,
            .inst = (tm_tab_o *)tab,
            .root_id = *id,
        },
        .allocator = allocator,
    };
    *id += 1000000;
    return &amp;tab-&gt;tm_tab_i;
}
static void tab__destroy(tm_tab_o *tab)
{
    tm_allocator_i a = tab-&gt;allocator;
    tm_free(&amp;a, tab, sizeof(*tab));
    tm_allocator_api-&gt;destroy_child(&amp;a);
}
static tm_tab_vt *custom_tab_vt = &amp;(tm_tab_vt){
    .name = TM_CUSTOM_TAB_VT_NAME,
    .name_hash = TM_CUSTOM_TAB_VT_NAME_HASH,
    .create_menu_name = tab__create_menu_name,
    .create = tab__create,
    .destroy = tab__destroy,
    .title = tab__title,
    .ui = tab__ui};
TM_DLL_EXPORT void tm_load_plugin(struct tm_api_registry_api *reg, bool load)
{
    tm_global_api_registry = reg;

    tm_draw2d_api = tm_get_api(reg, tm_draw2d_api);
    tm_ui_api = tm_get_api(reg, tm_ui_api);
    tm_allocator_api = tm_get_api(reg, tm_allocator_api);

    tm_add_or_remove_implementation(reg, load, tm_tab_vt, custom_tab_vt);
}
</code></pre>
<h2 id="code-structure"><a class="header" href="#code-structure">Code structure</a></h2>
<p>Let us dissect the code structure and discuss all the points of interest.</p>
<h3 id="api-and-include-region"><a class="header" href="#api-and-include-region">API and include region</a></h3>
<p>The file begins with all includes and API definitions: </p>
<pre><code class="language-c">static struct tm_api_registry_api *tm_global_api_registry;

static struct tm_draw2d_api *tm_draw2d_api;
static struct tm_ui_api *tm_ui_api;
static struct tm_allocator_api *tm_allocator_api;

#include &lt;foundation/allocator.h&gt;
#include &lt;foundation/api_registry.h&gt;

#include &lt;plugins/ui/docking.h&gt;
#include &lt;plugins/ui/draw2d.h&gt;
#include &lt;plugins/ui/ui.h&gt;
#include &lt;plugins/ui/ui_custom.h&gt;

#include &lt;the_machinery/the_machinery_tab.h&gt;

#include &lt;stdio.h&gt;
#define TM_CUSTOM_TAB_VT_NAME &quot;tm_custom_tab&quot;
#define TM_CUSTOM_TAB_VT_NAME_HASH                                             \
  TM_STATIC_HASH(&quot;tm_custom_tab&quot;, 0xbc4e3e47fbf1cdc1ULL)
</code></pre>
<p>The code will fill the API definitions with life in the <code>tm_load_plugin</code> function.</p>
<p>The most important aspects here are the two defines on the bottom:</p>
<pre><code class="language-c">#define TM_CUSTOM_TAB_VT_NAME &quot;tm_custom_tab&quot;
#define TM_CUSTOM_TAB_VT_NAME_HASH                                             \
  TM_STATIC_HASH(&quot;tm_custom_tab&quot;, 0xbc4e3e47fbf1cdc1ULL)
</code></pre>
<p>The first one defines the name of our Tab and the second one represents its hash value. The hash value can be used later on to access, search the Tab in the <a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_docking_api"><code>tm_docking_api</code></a>.</p>
<blockquote>
<p><strong>Note:</strong> If you modify the values, please ensure you ran <code>hash.exe</code> again or <code>tmbuild --gen-hash</code> so the hash value is updated!</p>
</blockquote>
<h3 id="define-your-data"><a class="header" href="#define-your-data">Define your Data</a></h3>
<p>In the next section, we define the data the Tab can hold. It might be any data you need for the Tab to work and do its job. The tab instance owns the data. It is not shared between Tabs instances. Therefore its lifetime is bound to the current instance.</p>
<pre><code class="language-c">struct tm_tab_o {
  tm_tab_i tm_tab_i;
  tm_allocator_i allocator;
};
</code></pre>
<p>A <a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_i"><code>tm_tab_i</code></a> represents a tab object. A tab object is represented as a <code>vtable</code> that defines its function interface and an opaque pointer to the Tab's internal data. This design is used so that the application layer can extend the <code>vtable</code> with its own interface.</p>
<h3 id="define-the-actual-tab"><a class="header" href="#define-the-actual-tab">Define the actual Tab</a></h3>
<p>Every Tab in The Machinery is based on the <a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt"><code>tm_tab_vt</code></a> and registered to the <a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt"><code>tm_tab_vt</code></a> in the <code>tm_load_plugin()</code> function.</p>
<p>The default <a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt"><code>tm_tab_vt</code></a> offers multiple options and settings we can set for our Tab. </p>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.name"><code>tm_tab_vt.name</code></a></td><td>Name uniquely identifying this tab type.</td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.name_hash"><code>tm_tab_vt.name_hash</code></a></td><td>A hash of the <code>name</code>.</td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.create_menu_name()"><code>tm_tab_vt.create_menu_name</code></a>()</td><td>Optional. Returns the (localized) name that should be shown for this tab type in menus that allow you to create new tabs. If this function returns <code>NULL</code>, the tab type won't appear in these menus. This can be used for tabs that should only be accessible when certain feature flags are set.</td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.create_menu_category()"><code>tm_tab_vt.create_menu_category</code></a>()</td><td>Optional. Returns the (localized) category that should be shown for this tab type in menus that allow you to create new tabs. If this function returns <code>NULL</code> or is not set, the tab type will appear at the root level of the menu, uncategorized.</td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.create()"><code>tm_tab_vt.create</code></a>()</td><td>Creates a new tab of this type and returns a pointer to it. <a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#tm_tab_create_context_t"><code>tm_tab_create_context_t</code></a> is an application defined type containing all the data a tab needs in order to be created. <code>ui</code> s the UI that the tab will be created in.</td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.destroy()"><code>tm_tab_vt.destroy</code></a>()</td><td>Destroys the tab</td></tr>
<tr><td><strong>Object methods</strong></td><td></td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.ui()"><code>tm_tab_vt.ui</code></a>()</td><td>Callback for drawing the content of the tab into the specified rect. The <code>uistyle</code> is the <a href="https://ourmachinery.com/apidoc/plugins/ui/ui.h.html#structtm_ui_api.default_style()"><code>tm_ui_api.default_style</code></a>() with the clipping rect set to <code>rect</code>.</td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.ui_serial()"><code>tm_tab_vt.ui_serial</code></a>()</td><td>Optional. If implemented, called from the main UI job once all parallel UI rendering (fork/join) has finished. This can be used for parts of the UI that needs to run serially, for example because they call out to non-thread-safe function.</td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.hidden_update()"><code>tm_tab_vt.hidden_update</code></a>()</td><td>This function is o<em>ptional.</em> If the Tab wants to do some processing when it is <em>not</em> the selected Tab in its tabwell, it can implement this callback. This will be called for all created tabs whose content is currently <em>not</em> visible.</td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.title()"><code>tm_tab_vt.title</code></a>()</td><td>Returns the localized title to be displayed for the tab. This typically consists of the name of the tab together with the document that is being edited, such as &quot;Scene: Kitchen*&quot;</td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.set_root()"><code>tm_tab_vt.set_root</code></a>()</td><td>Optional. Sets the root object of the tab. If a new Truth is loaded, this is called with <code>set_root(inst, new_tt, 0)</code>.</td></tr>
<tr><td><code> tm_tab_vt.root</code>()</td><td>Returns the root object and The Truth that is being edited in the tab. This is used, among other things to determine the undo queue that should be used for Undo/Redo operations when the tab has focus</td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.restore_settings()"><code>tm_tab_vt.restore_settings</code></a>()</td><td>Optional. Allow the tab to  restore it's own <em>state</em> to the settings. For example the Asset Browser will use this to save the view size of the assets.</td></tr>
<tr><td><code>  tm_tab_vt.save_settings</code>()</td><td>Optional. Allow the tab to save it's own <em>state</em> to the settings. For example the Asset Browser will use this to save the view size of the assets.</td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.can_close()"><code>tm_tab_vt.can_close</code></a>()</td><td>Optional. Returns <em>true</em> if the tab can be closed right now and <em>false</em> otherwise. A tab might not be able to close if it's in the middle of an important operation. Tabs that do not implement this method can be closed at any time.</td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.focus_event()"><code>tm_tab_vt.focus_event</code></a>()</td><td><a href="https://ourmachinery.com//apidoc/plugins/ui/docking.h.html#structtm_tab_vt.focus_event()">documentation</a></td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.feed_events()"><code>tm_tab_vt.feed_events</code></a>()</td><td>Optional. For feeding events to the tab. Useful for feeding events to UIs that are internal  to a tab.</td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.process_dropped_os_files()"><code>tm_tab_vt.process_dropped_os_files</code></a>()</td><td>Optional. If set, the tab will receive the path to the files that were dropped from the OS since the previous frame.</td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.toolbars()"><code>tm_tab_vt.toolbars</code></a>()</td><td>Optional. Returns a carray of toolbars to be drawn in the tab, allocated using <code>ta</code>.  <a href="#">How to add toolbars</a></td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.need_update()"><code>tm_tab_vt.need_update</code></a>()</td><td>Optional. Allow the tab to decide whether it's UI needs an update. Tabs that have animated components like the pong tab will return always true, while other tab may decide to return true only under certain circumstances. If not provided, the assumed default value will be true, so the tab will be updated every frame. If it returns false the UI will be cached. Therefore any call to <code>.ui</code> wont be called.</td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.hot_reload()"><code>tm_tab_vt.hot_reload</code></a>()</td><td>Optional. Will be called after any code hot reload has happened.</td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.entity_context()"><code>tm_tab_vt.entity_context</code></a>()</td><td>Optional. Should be implemented if tab owns an entity context.</td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.viewer_render_args()"><code>tm_tab_vt.viewer_render_args</code></a>()</td><td>Optional. Should be implemented if tab owns an entity context that supports to be rendered outside of it's UI callbacks.</td></tr>
<tr><td><strong>Flags</strong></td><td></td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.cant_be_pinned"><code>tm_tab_vt.cant_be_pinned</code></a></td><td>If set to <em>true</em>, the tab can't be pinned even though it has a <em>root</em> function.</td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.run_as_job"><code>tm_tab_vt.run_as_job</code></a></td><td>If set to <em>true</em>, the tab's UI will run as a background job, parallel to the rest of the UI  rendering. <strong>Warning:</strong> Setting this to <em>true</em> indicates to the docking system that the <code>ui()</code> function is thread-safe. If the function is not actually thread-safe you will see threading errors.</td></tr>
<tr><td><a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.dont_restore_at_startup"><code>tm_tab_vt.dont_restore_at_startup</code></a></td><td>If set to <em>true</em>, the tab will be considered <em>volatile</em>, and it won't be restored when the last opened project is automatically opened at startup, even if the user had the tab opened when the project was closed.</td></tr>
<tr><td><code>tm_tab_vt.dont_restore_root_asset_at_startup</code></td><td>If set to <em>true</em>, the tab will be restored at startup, but the root of the tab won't be set to the one that was set during application shutdown. Basically the project will be restored, but it will be always <em>empty</em>.</td></tr>
</tbody></table>
<p>In this example, we make use of the following options:</p>
<pre><code class="language-c">static tm_tab_vt *custom_tab_vt =
    &amp;(tm_tab_vt){.name = TM_CUSTOM_TAB_VT_NAME,
                 .name_hash = TM_CUSTOM_TAB_VT_NAME_HASH,
                 .create_menu_name = tab__create_menu_name,
                 .create = tab__create,
                 .destroy = tab__destroy,
                 .title = tab__title,
                 .ui = tab__ui};
</code></pre>
<p>In the cause of the rest of this walkthrough, we will discuss:<code>tab__create_menu_name</code>,  <code>tab__create</code>, <code>tab__destroy</code> , <code>tab__title</code> and <code>tab__ui</code>.</p>
<h3 id="define-the-metadata-functions"><a class="header" href="#define-the-metadata-functions">Define the metadata functions</a></h3>
<p>As we can see in our definition of the <code>custom_tab_vt</code> object we provide the <a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.create_menu_name()"><code>tm_tab_vt.create_menu_name()</code></a> and the <a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.title()"><code>tm_tab_vt.title()</code></a>. The <code>create_menu_name</code> is an optional function to allow you to provide a name for the create tab menu. In contrast, the <code>title()</code> function is not optional and is needed. It provides the name of the Tab, which the editor shall show in the tab bar.</p>
<pre><code class="language-c">{{insert_code(env.TM_BOOK_CODE_SNIPPETS/plugins/my_tab.c,tab_meta}}
</code></pre>
<h3 id="define-create-and-destroy-the-tab"><a class="header" href="#define-create-and-destroy-the-tab">Define create and destroy the Tab</a></h3>
<p>As mentioned before, the data of a tab is bound to its lifetime. Therefore you should create the data on <code>create</code> and let go of it on <code>destroy.</code></p>
<p>The create function provides you the <a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#tm_tab_create_context_t"><code>tm_tab_create_context_t</code></a> access to many essential things, such as an allocator. This allocator is the one you should use directly or create a child allocator.</p>
<blockquote>
<p><strong>Note:</strong> for more information check <a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#tm_tab_create_context_t"><code>tm_tab_create_context_t</code></a>'s documentation.</p>
</blockquote>
<pre><code class="language-c">static tm_tab_vt *custom_tab_vt;

static tm_tab_i *tab__create(tm_tab_create_context_t *context, tm_ui_o *ui) {
  tm_allocator_i allocator =
      tm_allocator_api-&gt;create_child(context-&gt;allocator, &quot;Custom Tab&quot;);
  uint64_t *id = context-&gt;id;
  tm_tab_o *tab = tm_alloc(&amp;allocator, sizeof(tm_tab_o));
  *tab = (tm_tab_o){
      .tm_tab_i =
          {
              .vt = custom_tab_vt,
              .inst = (tm_tab_o *)tab,
              .root_id = *id,
          },
      .allocator = allocator,
  };
  *id += 1000000;
  return &amp;tab-&gt;tm_tab_i;
}
</code></pre>
<p>We use the provided allocator to allocate the Tab struct, and then we initialize it with the data we deem to be needed. </p>
<pre><code class="language-c">tm_tab_o *tab = tm_alloc(&amp;allocator, sizeof(tm_tab_o));
*tab = (tm_tab_o){
    .tm_tab_i =
        {
            .vt = custom_tab_vt,
            .inst = (tm_tab_o *)tab,
            .root_id = *id,
        },
    .allocator = allocator,
};
</code></pre>
<p>Since we have allocated something, we need to keep track of the used allocator! Hence we have it as a member in our Tab struct.</p>
<p>In the end, we pass a pointer to the Tab interface.</p>
<pre><code class="language-c"> return &amp;tab-&gt;tm_tab_i;
</code></pre>
<p>When it comes to free the Tab data, we can just call <a href="https://ourmachinery.com/apidoc/foundation/allocator.h.html#tm_free()"><code>tm_free()</code></a> on our Tab:</p>
<pre><code class="language-c">static void tab__destroy(tm_tab_o *tab) {
  tm_allocator_i a = tab-&gt;allocator;
  tm_free(&amp;a, tab, sizeof(*tab));
  tm_allocator_api-&gt;destroy_child(&amp;a);
}
</code></pre>
<h2 id="define-the-ui-update"><a class="header" href="#define-the-ui-update">Define the UI update</a></h2>
<p>In the default example, we create a Tab that only updates when the Tab is active and visible. Therefore we do not need the <a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.hidden_update()"><code>tm_tab_vt.hidden_update()</code></a> function and can just implement the required one: <a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.ui()"><code>tm_tab_vt.ui()</code></a>.</p>
<p>The Tab itself shall not be jobifed since <code>run_as_job</code> is not provided (its default value is false). Therefore we know our function itself may contain none thread safe elements.</p>
<p>If we wanted to make our Tab jobifed, we could make use of the <a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt.hidden_update()"><code>tm_tab_vt.hidden_update()</code></a> function. This function is o<em>ptional.</em> If the Tab wants to do some processing when it is <em>not</em> the selected Tab in its tabwell, it can implement this callback. This will be called for all created tabs whose content is currently <em>not</em> visible.</p>
<p>Let us digest the current code line by line:</p>
<pre><code class="language-c">static void tab__ui(tm_tab_o *tab, tm_ui_o *ui, const tm_ui_style_t *uistyle_in,
                    tm_rect_t rect) {
  tm_ui_buffers_t uib = tm_ui_api-&gt;buffers(ui);
  tm_ui_style_t *uistyle = (tm_ui_style_t[]){*uistyle_in};
  tm_draw2d_style_t *style = &amp;(tm_draw2d_style_t){0};
  tm_ui_api-&gt;to_draw_style(ui, style, uistyle);
  style-&gt;color = (tm_color_srgb_t){.a = 255, .r = 255};
  tm_draw2d_api-&gt;fill_rect(uib.vbuffer, *uib.ibuffers, style, rect);
}
static const char *tab__create_menu_name(void) { return &quot;Custom Tab&quot;; }

static const char *tab__title(tm_tab_o *tab, struct tm_ui_o *ui) {
  return &quot;Custom Tab&quot;;
}
static tm_tab_vt *custom_tab_vt;

static tm_tab_i *tab__create(tm_tab_create_context_t *context, tm_ui_o *ui) {
  tm_allocator_i allocator =
      tm_allocator_api-&gt;create_child(context-&gt;allocator, &quot;Custom Tab&quot;);
  uint64_t *id = context-&gt;id;
  tm_tab_o *tab = tm_alloc(&amp;allocator, sizeof(tm_tab_o));
  *tab = (tm_tab_o){
      .tm_tab_i =
          {
              .vt = custom_tab_vt,
              .inst = (tm_tab_o *)tab,
              .root_id = *id,
          },
      .allocator = allocator,
  };
  *id += 1000000;
  return &amp;tab-&gt;tm_tab_i;
}
static void tab__destroy(tm_tab_o *tab) {
  tm_allocator_i a = tab-&gt;allocator;
  tm_free(&amp;a, tab, sizeof(*tab));
  tm_allocator_api-&gt;destroy_child(&amp;a);
}
static tm_tab_vt *custom_tab_vt =
    &amp;(tm_tab_vt){.name = TM_CUSTOM_TAB_VT_NAME,
                 .name_hash = TM_CUSTOM_TAB_VT_NAME_HASH,
                 .create_menu_name = tab__create_menu_name,
                 .create = tab__create,
                 .destroy = tab__destroy,
                 .title = tab__title,
                 .ui = tab__ui};
TM_DLL_EXPORT void tm_load_plugin(struct tm_api_registry_api *reg, bool load) {
  tm_global_api_registry = reg;

  tm_draw2d_api = tm_get_api(reg, tm_draw2d_api);
  tm_ui_api = tm_get_api(reg, tm_ui_api);
  tm_allocator_api = tm_get_api(reg, tm_allocator_api);

  tm_add_or_remove_implementation(reg, load, tm_tab_vt, custom_tab_vt);
}
</code></pre>
<p>The <a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_docking_api"><code>tm_docking_api</code></a>, which will call our Tab's update, provides us with the essential information:</p>
<ul>
<li><code>tm_tab_o* tab</code> our tab data to access any data we need</li>
<li><code>tm_ui_o* ui</code> an instance of the UI, needed to call the <a href="https://ourmachinery.com/apidoc/plugins/ui/ui.h.html#structtm_ui_api"><code>tm_ui_api</code></a></li>
<li><code>const tm_ui_style_t* uistyle_in</code> an instance of the current UI style, can be used to create a local version of it to modify the UI Style for this Tab.</li>
<li><code>tm_rect_t rect</code> the render surface of the Tab.</li>
</ul>
<p>In the first line of the function body, we create a new instance of the UI Buffers. You may use them to access the underlying buffers for calls to the<a href="https://ourmachinery.com/apidoc/plugins/ui/draw2d.h.html#structtm_draw2d_api"><code>tm_draw2d_api</code></a>.Also, this object allows access to the commonly shared metrics and colors.</p>
<pre><code class="language-c">tm_ui_buffers_t uib = tm_ui_api-&gt;buffers(ui);
</code></pre>
<p>After this, we define our local copy of the UI Style. Then we create an empty <a href="https://ourmachinery.com/apidoc/plugins/ui/draw2d.h.html#structtm_draw2d_style_t"><code>tm_draw2d_style_t</code></a> instance. We need to create a Style from the UI Style. You need <code> tm_draw2d_style_t* style</code> later for drawing anything with our draw 2d api.</p>
<pre><code class="language-c">tm_ui_buffers_t uib = tm_ui_api-&gt;buffers(ui);
tm_ui_style_t *uistyle = (tm_ui_style_t[]){*uistyle_in};
tm_draw2d_style_t *style = &amp;(tm_draw2d_style_t){0};
tm_ui_api-&gt;to_draw_style(ui, style, uistyle);
</code></pre>
<p>Now we are set, and we can finally color our tab background to red. You can do this with the <a href="https://ourmachinery.com/apidoc/plugins/ui/draw2d.h.html#structtm_draw2d_api.fill_rect()"><code>tm_draw2d_api.fill_rect()</code></a> call. Beforehand we need to change our style's color to red and then call the <a href="https://ourmachinery.com/apidoc/plugins/ui/draw2d.h.html#structtm_draw2d_api.fill_rect()"><code>tm_draw2d_api.fill_rect()</code></a>. We need to pass in the vertex buffer and the index buffer pointer so the function can draw into them.</p>
<pre><code class="language-c">style-&gt;color = (tm_color_srgb_t){.a = 255, .r = 255};
tm_draw2d_api-&gt;fill_rect(uib.vbuffer, *uib.ibuffers, style, rect);
</code></pre>
<blockquote>
<p><strong>Note:</strong> For more information on the rational behind the UI System please check out this blog post <a href="https://ourmachinery.com/post/one-draw-call-ui/">https://ourmachinery.com/post/one-draw-call-ui/ </a></p>
</blockquote>
<h2 id="register-the-tab"><a class="header" href="#register-the-tab">Register the Tab</a></h2>
<p>The last thing before we can compile our project and test it in the Engine is registering the Tab to the Plugin System. As mentioned before, you need to register the Tab to the: <a href="https://ourmachinery.com/apidoc/plugins/ui/docking.h.html#structtm_tab_vt"><code>tm_tab_vt</code></a> .</p>
<pre><code class="language-c">TM_DLL_EXPORT void tm_load_plugin(struct tm_api_registry_api *reg, bool load) {
  tm_global_api_registry = reg;

  tm_draw2d_api = tm_get_api(reg, tm_draw2d_api);
  tm_ui_api = tm_get_api(reg, tm_ui_api);
  tm_allocator_api = tm_get_api(reg, tm_allocator_api);

  tm_add_or_remove_implementation(reg, load, tm_tab_vt, custom_tab_vt);
}
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../extending_the_machinery/write-a-plugin.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../extending_the_machinery/plugin-assets.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../extending_the_machinery/write-a-plugin.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../extending_the_machinery/plugin-assets.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
