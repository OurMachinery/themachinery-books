<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Create a Truth Type - The Machinery Book</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="../favicon.svg">
                        <link rel="shortcut icon" href="../favicon.png">
                <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
                <link rel="stylesheet" href="../css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="../index.html"><strong aria-hidden="true">1.</strong> Welcome</a></li><li class="chapter-item "><a href="../what_is_the_machinery.html"><strong aria-hidden="true">2.</strong> What is The Machinery</a></li><li class="chapter-item "><a href="../licenses.html"><strong aria-hidden="true">3.</strong> Licenses</a></li><li class="chapter-item "><a href="../glossary.html"><strong aria-hidden="true">4.</strong> Glossary</a></li><li class="chapter-item "><a href="../troubleshooting.html"><strong aria-hidden="true">5.</strong> Troubleshooting</a></li><li class="chapter-item "><a href="../getting_started/index.html"><strong aria-hidden="true">6.</strong> Getting Started</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../getting_started/what_is_in_the_package.html"><strong aria-hidden="true">6.1.</strong> What is in this package</a></li><li class="chapter-item "><a href="../getting_started/logging_in.html"><strong aria-hidden="true">6.2.</strong> Sign In</a></li><li class="chapter-item "><a href="../getting_started/project_setup.html"><strong aria-hidden="true">6.3.</strong> Project Setup</a></li><li class="chapter-item "><a href="../getting_started/new_project.html"><strong aria-hidden="true">6.4.</strong> New Project</a></li><li class="chapter-item "><a href="../getting_started/first_gameplay_project.html"><strong aria-hidden="true">6.5.</strong> First Gameplay Project</a></li><li class="chapter-item "><a href="../getting_started/sample-projects.html"><strong aria-hidden="true">6.6.</strong> Sample Projects</a></li><li class="chapter-item "><a href="../getting_started/migration_from_unity.html"><strong aria-hidden="true">6.7.</strong> The Machinery for Unity Dev's</a></li><li class="chapter-item "><a href="../getting_started/migration_from_unreal.html"><strong aria-hidden="true">6.8.</strong> The Machinery for Unreal 4 Dev's</a></li><li class="chapter-item "><a href="../getting_started/migration_from_godot.html"><strong aria-hidden="true">6.9.</strong> The Machinery for Godot Dev's</a></li><li class="chapter-item "><a href="../getting_started/introduction_to_c.html"><strong aria-hidden="true">6.10.</strong> Introduction to C</a></li></ol></li><li class="chapter-item "><a href="../the_editor/index.html"><strong aria-hidden="true">7.</strong> The Editor</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../the_editor/tabs.html"><strong aria-hidden="true">7.1.</strong> About Tabs</a></li><li class="chapter-item "><a href="../the_editor/entity_tree_tab.html"><strong aria-hidden="true">7.2.</strong> Entity Tree Tab</a></li><li class="chapter-item "><a href="../the_editor/scene_tab.html"><strong aria-hidden="true">7.3.</strong> Scene Tab</a></li><li class="chapter-item "><a href="../the_editor/properties_tab.html"><strong aria-hidden="true">7.4.</strong> Properties Tab</a></li><li class="chapter-item "><a href="../the_editor/asset_browser.html"><strong aria-hidden="true">7.5.</strong> Asset Browser</a></li><li class="chapter-item "><a href="../the_editor/simulate_tab.html"><strong aria-hidden="true">7.6.</strong> Simulate Tab</a></li><li class="chapter-item "><a href="../the_editor/preview_tab.html"><strong aria-hidden="true">7.7.</strong> Preview Tab</a></li><li class="chapter-item "><a href="../the_editor/customizations.html"><strong aria-hidden="true">7.8.</strong> Customizations</a></li></ol></li><li class="chapter-item "><a href="../editing_workflows/index.html"><strong aria-hidden="true">8.</strong> Editing Workflows</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../editing_workflows/entities.html"><strong aria-hidden="true">8.1.</strong> Entities</a></li><li class="chapter-item "><a href="../editing_workflows/import_assets.html"><strong aria-hidden="true">8.2.</strong> Import Assets</a></li><li class="chapter-item "><a href="../editing_workflows/import_projects.html"><strong aria-hidden="true">8.3.</strong> Import Projects</a></li><li class="chapter-item "><a href="../editing_workflows/asset_pipeline.html"><strong aria-hidden="true">8.4.</strong> Asset pipeline by Example</a></li><li class="chapter-item "><a href="../editing_workflows/shaders_materials.html"><strong aria-hidden="true">8.5.</strong> Meshes / Materials / Shaders</a></li><li class="chapter-item "><a href="../editing_workflows/prototypes.html"><strong aria-hidden="true">8.6.</strong> Prototypes</a></li><li class="chapter-item "><a href="../editing_workflows/simulation.html"><strong aria-hidden="true">8.7.</strong> Simulation</a></li><li class="chapter-item "><a href="../editing_workflows/visual-scripting.html"><strong aria-hidden="true">8.8.</strong> Visual Scripting: Entity Graphs</a></li><li class="chapter-item "><a href="../editing_workflows/physics.html"><strong aria-hidden="true">8.9.</strong> Physics</a></li><li class="chapter-item "><a href="../editing_workflows/animation/index.html"><strong aria-hidden="true">8.10.</strong> Animation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../editing_workflows/animation/animation-state-machine.html"><strong aria-hidden="true">8.10.1.</strong> Animation State Machines</a></li><li class="chapter-item "><a href="../editing_workflows/animation/animation-compression.html"><strong aria-hidden="true">8.10.2.</strong> Animation Compression</a></li></ol></li><li class="chapter-item "><a href="../editing_workflows/sound.html"><strong aria-hidden="true">8.11.</strong> Sound</a></li><li class="chapter-item "><a href="../editing_workflows/publish.html"><strong aria-hidden="true">8.12.</strong> Publish</a></li><li class="chapter-item "><a href="../editing_workflows/sculpting.html"><strong aria-hidden="true">8.13.</strong> Sculpt Tool / White boxing</a></li></ol></li><li class="chapter-item expanded "><a href="../the_truth/index.html"><strong aria-hidden="true">9.</strong> The Truth</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../the_truth/access_values.html"><strong aria-hidden="true">9.1.</strong> Access values</a></li><li class="chapter-item "><a href="../the_truth/create_an_object.html"><strong aria-hidden="true">9.2.</strong> Create an object</a></li><li class="chapter-item "><a href="../the_truth/modify_an_object.html"><strong aria-hidden="true">9.3.</strong> Modify an object</a></li><li class="chapter-item "><a href="../the_truth/common_types.html"><strong aria-hidden="true">9.4.</strong> Common Types</a></li><li class="chapter-item "><a href="../the_truth/aspects.html"><strong aria-hidden="true">9.5.</strong> Aspects</a></li><li class="chapter-item expanded "><a href="../the_truth/custom_truth_type.html" class="active"><strong aria-hidden="true">9.6.</strong> Create a Truth Type</a></li></ol></li><li class="chapter-item "><a href="../creation_graphs/concept.html"><strong aria-hidden="true">10.</strong> Creation Graphs</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../creation_graphs/intro_unity.html"><strong aria-hidden="true">10.1.</strong> Creation Graphs for Untiy Dev's</a></li><li class="chapter-item "><a href="../creation_graphs/intro_unreal.html"><strong aria-hidden="true">10.2.</strong> Creation Graphs for Unreal 4 Dev's</a></li><li class="chapter-item "><a href="../creation_graphs/node_types.html"><strong aria-hidden="true">10.3.</strong> Node Types</a></li><li class="chapter-item "><a href="../creation_graphs/shader_system.html"><strong aria-hidden="true">10.4.</strong> Shader System Interaction</a></li></ol></li><li class="chapter-item "><a href="../graphics/index.html"><strong aria-hidden="true">11.</strong> Graphics</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../graphics/default_render_pipeline.html"><strong aria-hidden="true">11.1.</strong> Default Render Pipeline</a></li><li class="chapter-item "><a href="../graphics/mesh_materials.html"><strong aria-hidden="true">11.2.</strong> Meshes / Materials</a></li><li class="chapter-item "><a href="../graphics/shaders.html"><strong aria-hidden="true">11.3.</strong> Shaders</a></li><li class="chapter-item "><a href="../graphics/the_machinery_shading_language.html"><strong aria-hidden="true">11.4.</strong> The Machinery Shading Language</a></li><li class="chapter-item "><a href="../graphics/tmsl_vs.html"><strong aria-hidden="true">11.5.</strong> .tmsl Visual Studio Extension</a></li></ol></li><li class="chapter-item "><a href="../extending_the_machinery/index.html"><strong aria-hidden="true">12.</strong> Extending The Machinery</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../extending_the_machinery/the_plugin_system.html"><strong aria-hidden="true">12.1.</strong> The Plugin System</a></li><li class="chapter-item "><a href="../extending_the_machinery/hot-reloading.html"><strong aria-hidden="true">12.2.</strong> Hot-reloading</a></li><li class="chapter-item "><a href="../extending_the_machinery/write-a-plugin.html"><strong aria-hidden="true">12.3.</strong> Write a plugin</a></li><li class="chapter-item "><a href="../extending_the_machinery/write-a-tab.html"><strong aria-hidden="true">12.4.</strong> Write a tab</a></li><li class="chapter-item "><a href="../extending_the_machinery/plugin-assets.html"><strong aria-hidden="true">12.5.</strong> Plugin assets</a></li><li class="chapter-item "><a href="../extending_the_machinery/application_hooks.html"><strong aria-hidden="true">12.6.</strong> Application Hooks</a></li></ol></li><li class="chapter-item "><a href="../gameplay_coding/index.html"><strong aria-hidden="true">13.</strong> Gameplay coding</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../gameplay_coding/simulation_entry.html"><strong aria-hidden="true">13.1.</strong> Simulation Entry in C</a></li><li class="chapter-item "><a href="../gameplay_coding/visual_scripting/index.html"><strong aria-hidden="true">13.2.</strong> Visual Scripting</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../gameplay_coding/visual_scripting/subgraphs.html"><strong aria-hidden="true">13.2.1.</strong> Subgraphs</a></li><li class="chapter-item "><a href="../gameplay_coding/visual_scripting/debugger.html"><strong aria-hidden="true">13.2.2.</strong> Debugger</a></li></ol></li><li class="chapter-item "><a href="../gameplay_coding/ecs/index.html"><strong aria-hidden="true">13.3.</strong> Entity Component System</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../gameplay_coding/ecs/what_are_components.html"><strong aria-hidden="true">13.3.1.</strong> What are components</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/how_entites_can_interact.html"><strong aria-hidden="true">13.3.2.</strong> How can Entities Interact?</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/how_to_design_system_or_engine.html"><strong aria-hidden="true">13.3.3.</strong> How to design a System or an Engine?</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/how_to_define_a_engine_system.html"><strong aria-hidden="true">13.3.4.</strong> How to define a System or an Engine?</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/how_to_register_a_system_or_engine.html"><strong aria-hidden="true">13.3.5.</strong> How to register a System or an Engine?</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/write_a_custom_component.html"><strong aria-hidden="true">13.3.6.</strong> Write a custom component</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/tagging_entities.html"><strong aria-hidden="true">13.3.7.</strong> Tagging Entities</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/filtering_entities.html"><strong aria-hidden="true">13.3.8.</strong> Filtering Entities</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/simulation_lifecycle.html"><strong aria-hidden="true">13.3.9.</strong> Simulation Lifecycle</a></li></ol></li><li class="chapter-item "><a href="../gameplay_coding/gameplay_entry_comparison.html"><strong aria-hidden="true">13.4.</strong> Gameplay Entry Point Comparison</a></li></ol></li><li class="chapter-item "><a href="../collaboration.html"><strong aria-hidden="true">14.</strong> Collaboration</a></li><li class="chapter-item "><a href="../qa_pipeline/index.html"><strong aria-hidden="true">15.</strong> QA Pipeline</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../qa_pipeline/statistics.html"><strong aria-hidden="true">15.1.</strong> Statistics Tab</a></li><li class="chapter-item "><a href="../qa_pipeline/profiler.html"><strong aria-hidden="true">15.2.</strong> Profiler Tab</a></li><li class="chapter-item "><a href="../qa_pipeline/memory.html"><strong aria-hidden="true">15.3.</strong> Memory Usage Tab</a></li><li class="chapter-item "><a href="../qa_pipeline/logging.html"><strong aria-hidden="true">15.4.</strong> Logging</a></li><li class="chapter-item "><a href="../qa_pipeline/how_to_write_unit_tests.html"><strong aria-hidden="true">15.5.</strong> Write your own unit tests</a></li><li class="chapter-item "><a href="../qa_pipeline/how_to_write_integration_tests.html"><strong aria-hidden="true">15.6.</strong> Write your own integration tests</a></li></ol></li><li class="chapter-item "><a href="../helper_tools/index.html"><strong aria-hidden="true">16.</strong> Helper Tools</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../helper_tools/tmbuild.html"><strong aria-hidden="true">16.1.</strong> How to use tmbuild</a></li><li class="chapter-item "><a href="../helper_tools/hash.html"><strong aria-hidden="true">16.2.</strong> How to use hash</a></li><li class="chapter-item "><a href="../helper_tools/tmbuild_package_reference.html"><strong aria-hidden="true">16.3.</strong> tmbuild package reference</a></li></ol></li><li class="chapter-item "><a href="../writing_an_executable.html"><strong aria-hidden="true">17.</strong> Writing an executable</a></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">The Machinery Book</h1>

                    <div class="right-buttons">
                                                <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        <a href="https://github.com/OurMachinery/themachinery-books" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                                                
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="create-a-custom-truth-type"><a class="header" href="#create-a-custom-truth-type">Create a custom Truth Type</a></h1>
<p>This walkthrough shows you how to create a type for the Truth. The Truth is our centralized data model for editing data in the Engine. For more details on the system itself, click here: <a href="https://ourmachinery.github.io/themachinery-books/the_machinery_book/the_truth/index.html">The Truth</a>. </p>
<p>You should have basic knowledge about how to write a custom plugin. If not, you might want to check this <a href="https://ourmachinery.github.io/themachinery-books/the_machinery_book/extending_the_machinery/the_plugin_system.html">Guide</a>. </p>
<p>We will cover the following topics:</p>
<ul>
<li>How to define a Type.</li>
<li>Type Properties</li>
</ul>
<p>After this walkthrough you could check out the <a href="https://ourmachinery.github.io/themachinery-books/tutorials//the_truth/custom_asset/index.html">&quot;Create a custom asset&quot;</a> tutorial! </p>
<p><strong>Table of Content</strong></p>
<ul>
<li><a href="#define-a-type">Define a Type</a></li>
<li><a href="#about-properties">About Properties</a></li>
<li><a href="#adding-properties">Adding properties</a></li>
<li><a href="#what-is-next">What is next?</a></li>
</ul>
<h2 id="define-a-type"><a class="header" href="#define-a-type">Define a Type</a></h2>
<p>A Truth-Type in The Machinery consists out of a name (its identifier) and properties. </p>
<blockquote>
<p><strong>Note:</strong> In theory, you could also define a Type without properties.</p>
</blockquote>
<p>To add a Type to the system, you need access to the Truth instance. The Engine may have more than one instance of a Truth. </p>
<blockquote>
<p><strong>Example:</strong> There is a Project Truth to keep all the project-related settings and an Engine/Application Truth that holds all the application-wide settings.</p>
</blockquote>
<p>Generally speaking, you want to define Truth Types at the beginning of the Engine's life cycle. Therefore the designated place is the <code>tm_load_plugin</code> function. The Truth has an <em>interface</em> to register a truth type creation function: <a href="https://ourmachinery.com/apidoc/foundation/the_truth.h.html#tm_the_truth_create_types_i">tm_the_truth_create_types_i</a>. </p>
<p>This interface expects a function of the signature: <code>void create_truth_types(tm_the_truth_o *tt)</code>. Whenever the Engine creates a Truth, it invokes this interface on all loaded plugins, and their types are registered. You do not need to register your Type to the interface if you want to register your Type to a specific Truth.</p>
<blockquote>
<p><strong>Note:</strong> Mostly this function is called: <code>create_truth_types</code></p>
</blockquote>
<p>Let us define a type. To do that, we need to get the <code>tm_truth_api</code> first:</p>
<pre><code class="language-c">// beginning of the source file
static struct tm_the_truth_api *tm_the_truth_api;
#include &lt;foundation/api_registry.h&gt;
#include &lt;foundation/the_truth.h&gt;
// ... other code
TM_DLL_EXPORT void tm_load_plugin(struct tm_api_registry_api *reg, bool load)
{
    tm_the_truth_api = tm_get_api(reg, tm_the_truth_api);
}
</code></pre>
<p>After this, we define our type name once as a constant char define and one hashed version. There are some conventions to keep in mind:</p>
<ol>
<li>The plain text define should start with: <code>TM_TT_TYPE__</code>.</li>
<li>The hashed define should start with: <code>TM_TT_TYPE_HASH__</code></li>
<li>The name may or may not start with <code>tm_</code> but the name plain text and the hashed version need to match!</li>
</ol>
<pre><code class="language-c">#define TM_TT_TYPE__MY_TYPE &quot;tm_my_type&quot;
#define TM_TT_TYPE_HASH__MY_TYPE TM_STATIC_HASH(&quot;tm_my_type&quot;, 0xde0e763ccd72b89aULL)
</code></pre>
<blockquote>
<p><strong>Tip:</strong> Do not forget to run <code>hash.exe.</code> Otherwise, the <a href="https://ourmachinery.com/apidoc/foundation/api_types.h.html#tm_static_hash()">TM_STATIC_HASH</a> macro will cause an error. You can also run <code>tmbuild --gen-hash</code></p>
</blockquote>
<p>It is good practice to place the types into a header file so others can use these types as well!  When that is done we can call the <code>tm_the_truth_api-&gt;create_object_type()</code> to create the actual type. It will return a <a href="https://ourmachinery.com/apidoc/foundation/api_types.h.html#structtm_tt_type_t">tm_tt_type_t</a> which is the identifier of our type. The <a href="https://ourmachinery.com/apidoc/foundation/api_types.h.html#structtm_tt_id_t">tm_tt_id_t</a> will also refer to the type here! </p>
<p>The function expects:</p>
<table><thead><tr><th>Argument</th><th>Description</th></tr></thead><tbody>
<tr><td><code>tm_the_truth_o *tt</code></td><td>The Truth instance. This function will add the type to this instance</td></tr>
<tr><td><code>const char *name</code></td><td>The name of the type. It will be hashed internally. Therefore the hash value of <code>TM_TT_TYPE__</code>  and <code>TM_TT_TYPE_HASH___</code> should match!  <em>If a type with <code>name</code> already exists, that type is returned. Different types with the same <code>name</code> are not supported!</em></td></tr>
<tr><td><code>const tm_the_truth_property_definition_t *properties</code></td><td>The definitions of the properties of the type.</td></tr>
<tr><td><code> uint32_t num_properties</code></td><td>The number of properties. Should match <code>properties</code></td></tr>
</tbody></table>
<p>The home of this function should be our <code>void create_truth_types(tm_the_truth_o *tt)</code> . We need to add this one to our source file. After this we add the call to <code>create_object_type</code> to it. Remember that we have no properties yet, and our call would look like this:</p>
<pre><code class="language-c">static void create_truth_types(tm_the_truth_o *tt)
{
    tm_the_truth_api-&gt;create_object_type(tt, TM_TT_TYPE__MY_TYPE, 0, 0);
}
</code></pre>
<p>The last step is to tell the plugin system that we intend to register our <code>register_truth_type()</code>.</p>
<pre><code class="language-c">TM_DLL_EXPORT void tm_load_plugin(struct tm_api_registry_api *reg, bool load)
{
    tm_the_truth_api = tm_get_api(reg, tm_the_truth_api);
    tm_add_or_remove_implementation(reg, load, tm_the_truth_create_types_i, create_truth_types);
}
</code></pre>
<p>The full source code should look like this:</p>
<p><code>my_type.h</code></p>
<pre><code class="language-c">#pragma once
#include &lt;foundation/api_types.h&gt;

#define TM_TT_TYPE__MY_TYPE &quot;tm_my_type&quot;
#define TM_TT_TYPE_HASH__MY_TYPE TM_STATIC_HASH(&quot;tm_my_type&quot;, 0xde0e763ccd72b89aULL)
</code></pre>
<p>(Tip: Do not forget to run hash.exe)</p>
<p><code>my_type.c</code></p>
<pre><code class="language-c">// beginning of the source file
static struct tm_the_truth_api *tm_the_truth_api;
#include &lt;foundation/api_registry.h&gt;
#include &lt;foundation/the_truth.h&gt;
#include &quot;my_type.h&quot;

static void create_truth_types(tm_the_truth_o *tt)
{
    tm_the_truth_api-&gt;create_object_type(tt, TM_TT_TYPE__MY_TYPE, 0, 0);
}

TM_DLL_EXPORT void tm_load_plugin(struct tm_api_registry_api *reg, bool load)
{
    tm_the_truth_api = tm_get_api(reg, tm_the_truth_api);
    tm_add_or_remove_implementation(reg, load, tm_the_truth_create_types_i, create_truth_types);
}
</code></pre>
<p>After all of this you have registered your type and it could be used. This type is just not really useful without properties.</p>
<h2 id="about-properties"><a class="header" href="#about-properties">About Properties</a></h2>
<p>In The Truth, an Object-Type is made of one or multiple properties. Properties can represent the basic types:</p>
<ul>
<li><code>bool</code>, <code>string</code>, <code>float</code>, <code>UINT64</code>, <code>UNIT32</code>, <code>double</code>, `<code>buffer\</code></li>
<li><code>subobject</code> - An object that lives within this property </li>
<li><code>reference</code> - A reference to another object</li>
<li><code>subobject set</code> - A Set of subobjects</li>
<li><code>reference set</code> - A Set of references.</li>
</ul>
<p><em>What is the difference between a reference and a subobject?</em></p>
<p>To see the difference, consider how <a href="https://ourmachinery.com/apidoc/foundation/the_truth.h.html#structtm_the_truth_api.clone_object()">clone_object()</a> works in both cases:</p>
<ul>
<li>When you clone an object with references, the clone will reference the same objects as the original, i.e. they now have multiple references to them.</li>
<li>When you clone an object with subobjects, all the subobjects will be cloned too. After the clone operation, there is no link between the object's subobjects and the clone's subobjects.</li>
</ul>
<p>An arbitrary number of objects can reference the same object, but a subobject only has a single owner.</p>
<p>When you destroy an object, any references to that object become NIL references — i.e., they no longer refer to anything.</p>
<p>When you destroy an object that has subobjects, all the subobjects are destroyed with it.</p>
<blockquote>
<p><strong>Note:</strong> For more information please check: <a href="https://ourmachinery.com/apidoc/foundation/the_truth.h.html#the_truth.h">The API Documentation</a> </p>
</blockquote>
<h2 id="adding-properties"><a class="header" href="#adding-properties">Adding properties</a></h2>
<p>Let us add some properties to our Type! As you remember, when we created the Type, the function <code>create_object_type()</code> required a pointer to the definition of properties. You can define properties via the <a href="https://ourmachinery.com/apidoc/foundation/the_truth.h.html#structtm_the_truth_property_definition_t">tm_the_truth_property_definition_t</a> struct.</p>
<pre><code class="language-c">typedef struct tm_the_truth_property_definition_t
{
    // Name of the property, e.g. &quot;cast_shadows&quot;.
    //
    // This name is used both for serialization and for the UI of editing the property. When
    // displayed in the UI, the name will be automatically capitalized (e.g. &quot;Cast Shadows&quot;).
    //
    // The name shouldn't be longer than [[TM_THE_TRUTH_PROPERTY_NAME_LENGTH]] characters.
    const char *name;

    // [[enum tm_the_truth_property_type]] type of the property.
    tm_the_truth_property_type type;

    // [[enum tm_the_truth_editor]] enum defining what editor should be used for editing the property.
    uint32_t editor;

    // Editor specific settings.
    union
    {
        tm_the_truth_editor_enum_t enum_editor;
        tm_the_truth_editor_string_open_path_t string_open_path_editor;
        tm_the_truth_editor_string_save_path_t string_save_path_editor;
    };

    // For properties referring to other objects (references &amp; subobjects), specifies the type of
    // objects that they can refer to. A value of [[TM_TT_TYPE__ANYTHING]] is used for an object
    // that can refer to anything.
    //
    // Note: We currently don't have any system for representing &quot;interfaces&quot; or groups of types.
    // I.e. you can't say &quot;I want this to reference any type that inherits from the GRAPH_NODE_TYPE,
    // but no other types.&quot; We may add this in the future.
    tm_strhash_t type_hash;

    // Specifies that the property is allowed to refer to other types than the `type_hash`.
    //
    // !!! NOTE: Note
    //     This flag should not be used going forward. Instead, if a property can refer to multiple
    //     types, you should use a `type_hash` of [[TM_TT_TYPE__ANYTHING]]. It is provided for
    //     compatibility purposes, because some object types have a `type_hash` specified but
    //     store subobjects of other types. We cannot simply change the `type_hash` of those objects
    //     to [[TM_TT_TYPE__ANYTHING]], because there may be saved data that has serialized versions
    //     of those objects that omits the object type (if it is `type_hash`). We can't deserialize
    //     those objects if we don't know the `type_hash` of the type.
    bool allow_other_types;
    TM_PAD(7);

    // For buffer properties, the extension (if any) used to represent the buffer type. This can
    // either be hard-coded in `buffer_extension`, or computed by the `buffer_extension_f()`
    // callback (set the unused option to `NULL`).
    const char *buffer_extension;
    const char *(*buffer_extension_f)(const tm_the_truth_o *tt, tm_tt_id_t object, uint32_t property);

    // Tooltip used to describe the property in more detail. The tooltip text will be displayed in
    // the property editor when the property is hovered over.
    //
    // The tooltip should be registered using [[TM_LOCALIZE_LATER()]]. It will be dynamically
    // localized to the current interface language with [[TM_LOCALIZE_DYNAMIC()]] before being
    // displayed in the UI.
    const char *tooltip;

    // If *true*, this property will be skipped during serialization.
    bool not_serialized;
    TM_PAD(7);

    // If specified, this will be used instead of `name` for the UI.
    const char *ui_name;
} tm_the_truth_property_definition_t;
</code></pre>
<p>(<a href="https://ourmachinery.com/apidoc/foundation/the_truth.h.html#structtm_the_truth_property_definition_t">API Documentation</a>)</p>
<p>Within our <code>create_truth_types</code> we create an array of type <a href="https://ourmachinery.com/apidoc/foundation/the_truth.h.html#structtm_the_truth_property_definition_t">tm_the_truth_property_definition_t</a>. For this example, we define the properties of type bool and string.</p>
<pre><code class="language-c">// beginning of the source file
static struct tm_the_truth_api *tm_the_truth_api;
#include &lt;foundation/api_registry.h&gt;
// include [macros.h](https://ourmachinery.com/apidoc/foundation/macros.h.html#macros.h) to access TM_ARRAY_COUNT for convinace:
#include &lt;foundation/macros.h&gt;
#include &lt;foundation/the_truth.h&gt;

#include &quot;my_type.h&quot;

static void create_truth_types(tm_the_truth_o *tt)
{
    tm_the_truth_property_definition_t properties[] = {
        {&quot;my_bool&quot;, TM_THE_TRUTH_PROPERTY_TYPE_BOOL},
        {&quot;my_string&quot;, TM_THE_TRUTH_PROPERTY_TYPE_STRING},
    };
    tm_the_truth_api-&gt;create_object_type(tt, TM_TT_TYPE__MY_TYPE, properties, TM_ARRAY_COUNT(properties));
}

TM_DLL_EXPORT void tm_load_plugin(struct tm_api_registry_api *reg, bool load)
{
    tm_the_truth_api = tm_get_api(reg, tm_the_truth_api);
    tm_add_or_remove_implementation(reg, load, tm_the_truth_create_types_i, create_truth_types);
}
</code></pre>
<p>That is all we need to do to define properties for our Type! Also thanks to our automatic &quot;reflection&quot; system you do not have to worry about providing a UI for the type. The Properties View will automatically provide a UI for this type.</p>
<h2 id="what-is-next"><a class="header" href="#what-is-next">What is next?</a></h2>
<p>You can find more in depth and practical tutorials in the <a href="https://ourmachinery.github.io/themachinery-books/tutorials//the_truth/index.html">tutorial book</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="../the_truth/aspects.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="../creation_graphs/concept.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="../the_truth/aspects.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="../creation_graphs/concept.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
