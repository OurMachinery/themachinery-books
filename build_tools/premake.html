<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Premake - The Machinery Book</title>
        <!-- Custom HTML head -->
<meta name="twitter:card" content="summary_large_image" />

<meta name="twitter:image" content="https://ourmachinery.com/images/machinery-logo.png" />
<meta name="twitter:title" content="Our Machinery">
<meta name="twitter:description" content="Our Machinery" />

<meta name="twitter:site" content="@ourmachinery" />


<meta property="og:title" content="Tutorials &middot; Our Machinery" />
<meta property="og:site_name" content="Our Machinery" />
<meta property="og:url" content="https://ourmachinery.com/tutorials/" />

<meta property="og:image" content="https://ourmachinery.com/images/machinery-logo.png" />


<meta property="og:type" content="website" />
<meta property="og:description" content="Our Machinery" />        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="../index.html"><strong aria-hidden="true">1.</strong> Welcome</a></li><li class="chapter-item "><a href="../what_is_the_machinery.html"><strong aria-hidden="true">2.</strong> What is The Machinery</a></li><li class="chapter-item "><a href="../licenses.html"><strong aria-hidden="true">3.</strong> Licenses</a></li><li class="chapter-item "><a href="../faq.html"><strong aria-hidden="true">4.</strong> FAQ</a></li><li class="chapter-item "><a href="../glossary.html"><strong aria-hidden="true">5.</strong> Glossary</a></li><li class="chapter-item "><a href="../troubleshooting.html"><strong aria-hidden="true">6.</strong> Troubleshooting</a></li><li class="chapter-item "><a href="../contributing.html"><strong aria-hidden="true">7.</strong> Contribution</a></li><li class="chapter-item "><a href="../getting_started/index.html"><strong aria-hidden="true">8.</strong> Getting Started</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../getting_started/what_is_in_the_package.html"><strong aria-hidden="true">8.1.</strong> Contents of binary distribution</a></li><li class="chapter-item "><a href="../getting_started/logging_in.html"><strong aria-hidden="true">8.2.</strong> Sign In</a></li><li class="chapter-item "><a href="../getting_started/project_setup.html"><strong aria-hidden="true">8.3.</strong> Project Setup</a></li><li class="chapter-item "><a href="../getting_started/version_control.html"><strong aria-hidden="true">8.4.</strong> Version Control</a></li><li class="chapter-item "><a href="../getting_started/new_project.html"><strong aria-hidden="true">8.5.</strong> New Project</a></li><li class="chapter-item "><a href="../getting_started/first_gameplay_project.html"><strong aria-hidden="true">8.6.</strong> First Gameplay Project</a></li><li class="chapter-item "><a href="../getting_started/sample-projects.html"><strong aria-hidden="true">8.7.</strong> Sample Projects</a></li><li class="chapter-item "><a href="../getting_started/migration_from_unity.html"><strong aria-hidden="true">8.8.</strong> The Machinery for Unity Devs</a></li><li class="chapter-item "><a href="../getting_started/migration_from_unreal.html"><strong aria-hidden="true">8.9.</strong> The Machinery for Unreal 4 Devs</a></li><li class="chapter-item "><a href="../getting_started/migration_from_godot.html"><strong aria-hidden="true">8.10.</strong> The Machinery for Godot Devs</a></li><li class="chapter-item "><a href="../getting_started/introduction_to_c/index.html"><strong aria-hidden="true">8.11.</strong> Introduction to C</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../getting_started/introduction_to_c/memory_management.html"><strong aria-hidden="true">8.11.1.</strong> Memory Management</a></li><li class="chapter-item "><a href="../getting_started/introduction_to_c/list_arrays_vector.html"><strong aria-hidden="true">8.11.2.</strong> List, Arrays, Vectors</a></li><li class="chapter-item "><a href="../getting_started/introduction_to_c/hashmaps_and_set.html"><strong aria-hidden="true">8.11.3.</strong> HashMaps &amp; Sets</a></li><li class="chapter-item "><a href="../getting_started/introduction_to_c/concurrency.html"><strong aria-hidden="true">8.11.4.</strong> Concurrency in Machinery</a></li><li class="chapter-item "><a href="../getting_started/introduction_to_c/strings.html"><strong aria-hidden="true">8.11.5.</strong> String processing</a></li><li class="chapter-item "><a href="../getting_started/introduction_to_c/other.html"><strong aria-hidden="true">8.11.6.</strong> Types: void* and struct padding</a></li></ol></li></ol></li><li class="chapter-item "><a href="../the_editor/index.html"><strong aria-hidden="true">9.</strong> The Editor</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../the_editor/tabs.html"><strong aria-hidden="true">9.1.</strong> About Tabs</a></li><li class="chapter-item "><a href="../the_editor/entity_tree_tab.html"><strong aria-hidden="true">9.2.</strong> Entity Tree Tab</a></li><li class="chapter-item "><a href="../the_editor/scene_tab.html"><strong aria-hidden="true">9.3.</strong> Scene Tab</a></li><li class="chapter-item "><a href="../the_editor/properties_tab.html"><strong aria-hidden="true">9.4.</strong> Properties Tab</a></li><li class="chapter-item "><a href="../the_editor/asset_browser.html"><strong aria-hidden="true">9.5.</strong> Asset Browser</a></li><li class="chapter-item "><a href="../the_editor/simulate_tab.html"><strong aria-hidden="true">9.6.</strong> Simulate Tab</a></li><li class="chapter-item "><a href="../the_editor/preview_tab.html"><strong aria-hidden="true">9.7.</strong> Preview Tab</a></li><li class="chapter-item "><a href="../the_editor/customizations.html"><strong aria-hidden="true">9.8.</strong> Customizations</a></li></ol></li><li class="chapter-item "><a href="../editing_workflows/index.html"><strong aria-hidden="true">10.</strong> Editing Workflows</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../editing_workflows/entities.html"><strong aria-hidden="true">10.1.</strong> Entities</a></li><li class="chapter-item "><a href="../editing_workflows/import_assets.html"><strong aria-hidden="true">10.2.</strong> Import Assets</a></li><li class="chapter-item "><a href="../editing_workflows/import_projects.html"><strong aria-hidden="true">10.3.</strong> Import Projects</a></li><li class="chapter-item "><a href="../editing_workflows/asset_pipeline.html"><strong aria-hidden="true">10.4.</strong> Asset pipeline by Example</a></li><li class="chapter-item "><a href="../editing_workflows/prototype_workflow/index.html"><strong aria-hidden="true">10.5.</strong> Prototypes</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../editing_workflows/prototype_workflow/how_to_create_prototypes.html"><strong aria-hidden="true">10.5.1.</strong> How to Create Prototypes</a></li><li class="chapter-item "><a href="../editing_workflows/prototype_workflow/how_to_instantiate_prototypes.html"><strong aria-hidden="true">10.5.2.</strong> How to Instantiate Prototypes</a></li></ol></li><li class="chapter-item "><a href="../editing_workflows/shaders_materials.html"><strong aria-hidden="true">10.6.</strong> Meshes / Materials / Shaders</a></li><li class="chapter-item "><a href="../editing_workflows/simulation.html"><strong aria-hidden="true">10.7.</strong> Simulation</a></li><li class="chapter-item "><a href="../editing_workflows/visual-scripting.html"><strong aria-hidden="true">10.8.</strong> Visual Scripting: Entity Graphs</a></li><li class="chapter-item "><a href="../editing_workflows/physics.html"><strong aria-hidden="true">10.9.</strong> Physics</a></li><li class="chapter-item "><a href="../editing_workflows/animation/index.html"><strong aria-hidden="true">10.10.</strong> Animation</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../editing_workflows/animation/animation-state-machine.html"><strong aria-hidden="true">10.10.1.</strong> Animation State Machines</a></li><li class="chapter-item "><a href="../editing_workflows/animation/animation-compression.html"><strong aria-hidden="true">10.10.2.</strong> Animation Compression</a></li></ol></li><li class="chapter-item "><a href="../editing_workflows/sound.html"><strong aria-hidden="true">10.11.</strong> Sound</a></li><li class="chapter-item "><a href="../editing_workflows/publish.html"><strong aria-hidden="true">10.12.</strong> Publish</a></li><li class="chapter-item "><a href="../editing_workflows/sculpting.html"><strong aria-hidden="true">10.13.</strong> Sculpt Tool / White boxing</a></li></ol></li><li class="chapter-item "><a href="../the_truth/index.html"><strong aria-hidden="true">11.</strong> The Truth</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../the_truth/access_values.html"><strong aria-hidden="true">11.1.</strong> Access values</a></li><li class="chapter-item "><a href="../the_truth/create_an_object.html"><strong aria-hidden="true">11.2.</strong> Create an object</a></li><li class="chapter-item "><a href="../the_truth/modify_an_object.html"><strong aria-hidden="true">11.3.</strong> Modify an object</a></li><li class="chapter-item "><a href="../the_truth/common_types.html"><strong aria-hidden="true">11.4.</strong> Common Types</a></li><li class="chapter-item "><a href="../the_truth/aspects.html"><strong aria-hidden="true">11.5.</strong> Aspects</a></li><li class="chapter-item "><a href="../the_truth/custom_truth_type.html"><strong aria-hidden="true">11.6.</strong> Create a Truth Type</a></li></ol></li><li class="chapter-item "><a href="../creation_graphs/concept.html"><strong aria-hidden="true">12.</strong> Creation Graphs</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../creation_graphs/intro_unity.html"><strong aria-hidden="true">12.1.</strong> Creation Graphs for Untiy Dev's</a></li><li class="chapter-item "><a href="../creation_graphs/intro_unreal.html"><strong aria-hidden="true">12.2.</strong> Creation Graphs for Unreal 4 Dev's</a></li><li class="chapter-item "><a href="../creation_graphs/node_types.html"><strong aria-hidden="true">12.3.</strong> Node Types</a></li><li class="chapter-item "><a href="../creation_graphs/shader_system.html"><strong aria-hidden="true">12.4.</strong> Shader System Interaction</a></li></ol></li><li class="chapter-item "><a href="../graphics/index.html"><strong aria-hidden="true">13.</strong> Graphics</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../graphics/camera/index.html"><strong aria-hidden="true">13.1.</strong> Camera</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../graphics/camera/physical_light_and_camera.html"><strong aria-hidden="true">13.1.1.</strong> Physically Based Light and Cameras</a></li></ol></li><li class="chapter-item "><a href="../graphics/default_render_pipeline.html"><strong aria-hidden="true">13.2.</strong> Default Render Pipeline</a></li><li class="chapter-item "><a href="../graphics/mesh_materials.html"><strong aria-hidden="true">13.3.</strong> Meshes / Materials</a></li><li class="chapter-item "><a href="../graphics/shaders.html"><strong aria-hidden="true">13.4.</strong> Shaders</a></li><li class="chapter-item "><a href="../graphics/the_machinery_shading_language.html"><strong aria-hidden="true">13.5.</strong> The Machinery Shading Language</a></li><li class="chapter-item "><a href="../graphics/tmsl_vs.html"><strong aria-hidden="true">13.6.</strong> .tmsl Visual Studio Extension</a></li><li class="chapter-item "><a href="../graphics/lighting/index.html"><strong aria-hidden="true">13.7.</strong> Lighting</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../graphics/lighting/ambient_occlusion.html"><strong aria-hidden="true">13.7.1.</strong> Ambient Occlusion</a></li></ol></li><li class="chapter-item "><a href="../graphics/post_processing/index.html"><strong aria-hidden="true">13.8.</strong> Post Processing</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../graphics/post_processing/aa.html"><strong aria-hidden="true">13.8.1.</strong> Anti-Aliasing</a></li><li class="chapter-item "><a href="../graphics/post_processing/exposure.html"><strong aria-hidden="true">13.8.2.</strong> Exposure</a></li><li class="chapter-item "><a href="../graphics/post_processing/bloom.html"><strong aria-hidden="true">13.8.3.</strong> Bloom</a></li><li class="chapter-item "><a href="../graphics/post_processing/color_grading.html"><strong aria-hidden="true">13.8.4.</strong> Color Grading</a></li></ol></li></ol></li><li class="chapter-item "><a href="../extending_the_machinery/index.html"><strong aria-hidden="true">14.</strong> Extending The Machinery</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../extending_the_machinery/the_plugin_system.html"><strong aria-hidden="true">14.1.</strong> The Plugin System</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../extending_the_machinery/write-a-plugin.html"><strong aria-hidden="true">14.1.1.</strong> Write a plugin</a></li><li class="chapter-item "><a href="../extending_the_machinery/sample_plugin.html"><strong aria-hidden="true">14.1.2.</strong> Sample Plugins</a></li><li class="chapter-item "><a href="../extending_the_machinery/write-a-tab.html"><strong aria-hidden="true">14.1.3.</strong> Write a tab</a></li><li class="chapter-item "><a href="../extending_the_machinery/plugin-assets.html"><strong aria-hidden="true">14.1.4.</strong> Plugin assets</a></li></ol></li><li class="chapter-item "><a href="../extending_the_machinery/hot-reloading.html"><strong aria-hidden="true">14.2.</strong> Hot-reloading</a></li><li class="chapter-item "><a href="../extending_the_machinery/application_hooks.html"><strong aria-hidden="true">14.3.</strong> Application Hooks</a></li><li class="chapter-item "><a href="../build_tools/premake.html" class="active"><strong aria-hidden="true">14.4.</strong> Premake</a></li><li class="chapter-item "><a href="../build_tools/tmbuild.html"><strong aria-hidden="true">14.5.</strong> tmbuild</a></li></ol></li><li class="chapter-item "><a href="../gameplay_coding/index.html"><strong aria-hidden="true">15.</strong> Gameplay coding</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../gameplay_coding/simulation_entry.html"><strong aria-hidden="true">15.1.</strong> Simulation Entry in C</a></li><li class="chapter-item "><a href="../gameplay_coding/visual_scripting/index.html"><strong aria-hidden="true">15.2.</strong> Visual Scripting</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../gameplay_coding/visual_scripting/subgraphs.html"><strong aria-hidden="true">15.2.1.</strong> Subgraphs</a></li><li class="chapter-item "><a href="../gameplay_coding/visual_scripting/debugger.html"><strong aria-hidden="true">15.2.2.</strong> Debugger</a></li><li class="chapter-item "><a href="../gameplay_coding/visual_scripting/extend_the_entity_graph.html"><strong aria-hidden="true">15.2.3.</strong> Extending the Entity Graph</a></li><li class="chapter-item "><a href="../gameplay_coding/visual_scripting/provide_custom_data_type_to_the_entity_graph.html"><strong aria-hidden="true">15.2.4.</strong> Custom Data Type for the Entity Graph</a></li></ol></li><li class="chapter-item "><a href="../gameplay_coding/ecs/index.html"><strong aria-hidden="true">15.3.</strong> Entity Component System</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../gameplay_coding/ecs/what_are_components.html"><strong aria-hidden="true">15.3.1.</strong> What are components</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/how_entites_can_interact.html"><strong aria-hidden="true">15.3.2.</strong> How can Entities Interact?</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/how_to_design_system_or_engine.html"><strong aria-hidden="true">15.3.3.</strong> How to design a System or an Engine?</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/how_to_define_a_engine_system.html"><strong aria-hidden="true">15.3.4.</strong> How to define a System or an Engine?</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/how_to_register_a_system_or_engine.html"><strong aria-hidden="true">15.3.5.</strong> How to register a System or an Engine?</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/write_a_custom_component.html"><strong aria-hidden="true">15.3.6.</strong> Write a custom component</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/tagging_entities.html"><strong aria-hidden="true">15.3.7.</strong> Tagging Entities</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/filtering_entities.html"><strong aria-hidden="true">15.3.8.</strong> Filtering Entities</a></li><li class="chapter-item "><a href="../gameplay_coding/ecs/simulation_lifecycle.html"><strong aria-hidden="true">15.3.9.</strong> Simulation Lifecycle</a></li></ol></li><li class="chapter-item "><a href="../gameplay_coding/gameplay_entry_comparison.html"><strong aria-hidden="true">15.4.</strong> Gameplay Entry Point Comparison</a></li></ol></li><li class="chapter-item "><a href="../tutorials/index.html"><strong aria-hidden="true">16.</strong> Tutorials</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../tutorials/creation_graph/index.html"><strong aria-hidden="true">16.1.</strong> Creation Graph</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../tutorials/creation_graph/introduction_walkthrough/index.html"><strong aria-hidden="true">16.1.1.</strong> Creation Graph Introduction Series</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../tutorials/creation_graph/introduction_walkthrough/texture_compression.html"><strong aria-hidden="true">16.1.1.1.</strong> Simple Texture Compression</a></li><li class="chapter-item "><a href="../tutorials/creation_graph/introduction_walkthrough/creation_graph_prototype.html"><strong aria-hidden="true">16.1.1.2.</strong> Creation Graph Prototype</a></li><li class="chapter-item "><a href="../tutorials/creation_graph/introduction_walkthrough/custom_import_settings.html"><strong aria-hidden="true">16.1.1.3.</strong> Custom Import Settings</a></li></ol></li><li class="chapter-item "><a href="../tutorials/creation_graph/custom_gpu_nodes.html"><strong aria-hidden="true">16.1.2.</strong> Creating Custom GPU Nodes</a></li><li class="chapter-item "><a href="../tutorials/creation_graph/custom_cpu_nodes.html"><strong aria-hidden="true">16.1.3.</strong> Creating Custom CPU Nodes</a></li><li class="chapter-item "><a href="../tutorials/creation_graph/custom_geometry_node.html"><strong aria-hidden="true">16.1.4.</strong> Creating Custom Geometry Nodes</a></li><li class="chapter-item "><a href="../tutorials/creation_graph/from_code.html"><strong aria-hidden="true">16.1.5.</strong> Calling Creation Graphs from Code</a></li><li class="chapter-item "><a href="../tutorials/creation_graph/raymarch_output_node.html"><strong aria-hidden="true">16.1.6.</strong> Creating a Custom Raymarching Output Node</a></li></ol></li><li class="chapter-item "><a href="../tutorials/physics/index.html"><strong aria-hidden="true">16.2.</strong> Physics</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../tutorials/physics/triggers.html"><strong aria-hidden="true">16.2.1.</strong> Triggers</a></li><li class="chapter-item "><a href="../tutorials/physics/arkanoid.html"><strong aria-hidden="true">16.2.2.</strong> Arkanoid</a></li><li class="chapter-item "><a href="../tutorials/physics/contacts.html"><strong aria-hidden="true">16.2.3.</strong> Contacts</a></li><li class="chapter-item "><a href="../tutorials/physics/kinematic.html"><strong aria-hidden="true">16.2.4.</strong> Kinematic</a></li><li class="chapter-item "><a href="../tutorials/physics/stack.html"><strong aria-hidden="true">16.2.5.</strong> Stack</a></li></ol></li><li class="chapter-item "><a href="../tutorials/the_truth/index.html"><strong aria-hidden="true">16.3.</strong> The Truth</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../tutorials/the_truth/custom_asset/index.html"><strong aria-hidden="true">16.3.1.</strong> Creating a Custom Asset Type</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../tutorials/the_truth/custom_asset/part1.html"><strong aria-hidden="true">16.3.1.1.</strong> Part 1 - Create an Asset Truth Type, Addable via Asset Browser</a></li><li class="chapter-item "><a href="../tutorials/the_truth/custom_asset/part2.html"><strong aria-hidden="true">16.3.1.2.</strong> Part 2 - Custom UI</a></li><li class="chapter-item "><a href="../tutorials/the_truth/custom_asset/part3.html"><strong aria-hidden="true">16.3.1.3.</strong> Part 3 - Custom Importer</a></li></ol></li><li class="chapter-item "><a href="../tutorials/the_truth/drag_and_drop.html"><strong aria-hidden="true">16.3.2.</strong> Adding Drag and Drop to Assets</a></li><li class="chapter-item "><a href="../tutorials/the_truth/open_asset.html"><strong aria-hidden="true">16.3.3.</strong> Open Asset in Tab</a></li></ol></li><li class="chapter-item "><a href="../tutorials/network/index.html"><strong aria-hidden="true">16.4.</strong> Network</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../tutorials/network/animation_sample/network_assets.html"><strong aria-hidden="true">16.4.1.</strong> Part 1: Network Asset</a></li><li class="chapter-item "><a href="../tutorials/network/animation_sample/multiple_network_instances.html"><strong aria-hidden="true">16.4.2.</strong> Part 2: Multiple Instances</a></li><li class="chapter-item "><a href="../tutorials/network/animation_sample/entity_control.html"><strong aria-hidden="true">16.4.3.</strong> Part 3: Entity Control</a></li><li class="chapter-item "><a href="../tutorials/network/animation_sample/support_multiple_players.html"><strong aria-hidden="true">16.4.4.</strong> Part 4: Multiple Players</a></li><li class="chapter-item "><a href="../tutorials/network/animation_sample/basic_graph_variables.html"><strong aria-hidden="true">16.4.5.</strong> Part 5: Variable Replication (Graph)</a></li><li class="chapter-item "><a href="../tutorials/network/animation_sample/smooth_animation.html"><strong aria-hidden="true">16.4.6.</strong> Part 6: Smooth Animation</a></li><li class="chapter-item "><a href="../tutorials/network/animation_sample/spawning_entities.html"><strong aria-hidden="true">16.4.7.</strong> Part 7: Spawning Entities</a></li></ol></li><li class="chapter-item "><a href="../tutorials/ui/index.html"><strong aria-hidden="true">16.5.</strong> UI</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../tutorials/ui/build_custom_ui_controls/index.html"><strong aria-hidden="true">16.5.1.</strong> Build Custom UI Controls</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../tutorials/ui/build_custom_ui_controls/part1.html"><strong aria-hidden="true">16.5.1.1.</strong> Part 1</a></li></ol></li><li class="chapter-item "><a href="../tutorials/ui/toolbars-overlays.html"><strong aria-hidden="true">16.5.2.</strong> Toolbars and Overlays</a></li><li class="chapter-item "><a href="../tutorials/ui/custom_layouts.html"><strong aria-hidden="true">16.5.3.</strong> Custom Tab Layouts</a></li></ol></li></ol></li><li class="chapter-item "><a href="../collaboration.html"><strong aria-hidden="true">17.</strong> Collaboration</a></li><li class="chapter-item "><a href="../qa_pipeline/index.html"><strong aria-hidden="true">18.</strong> QA Pipeline</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../qa_pipeline/statistics.html"><strong aria-hidden="true">18.1.</strong> Statistics Tab</a></li><li class="chapter-item "><a href="../qa_pipeline/profiler.html"><strong aria-hidden="true">18.2.</strong> Profiler Tab</a></li><li class="chapter-item "><a href="../qa_pipeline/memory.html"><strong aria-hidden="true">18.3.</strong> Memory Usage Tab</a></li><li class="chapter-item "><a href="../qa_pipeline/logging.html"><strong aria-hidden="true">18.4.</strong> Logging</a></li><li class="chapter-item "><a href="../qa_pipeline/how_to_write_unit_tests.html"><strong aria-hidden="true">18.5.</strong> Write your own unit tests</a></li><li class="chapter-item "><a href="../qa_pipeline/how_to_write_integration_tests.html"><strong aria-hidden="true">18.6.</strong> Write your own integration tests</a></li></ol></li><li class="chapter-item expanded "><a href="../build_tools/index.html"><strong aria-hidden="true">19.</strong> Build Tools</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../build_tools/tmbuild.html"><strong aria-hidden="true">19.1.</strong> How to use tmbuild</a></li><li class="chapter-item "><a href="../build_tools/hash.html"><strong aria-hidden="true">19.2.</strong> How to use hash</a></li><li class="chapter-item "><a href="../build_tools/tmbuild_package_reference.html"><strong aria-hidden="true">19.3.</strong> tmbuild package reference</a></li><li class="chapter-item "><a href="../build_tools/libs_json_reference.html"><strong aria-hidden="true">19.4.</strong> Libs json reference</a></li><li class="chapter-item expanded "><a href="../build_tools/premake.html" class="active"><strong aria-hidden="true">19.5.</strong> Premake</a></li></ol></li><li class="chapter-item "><a href="../writing_an_executable.html"><strong aria-hidden="true">20.</strong> Writing an executable</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Machinery Book</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/OurMachinery/themachinery-books" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="premake-guide"><a class="header" href="#premake-guide">Premake Guide</a></h2>
<p>At Our Machinery we are using <a href="https://premake.github.io/">Premake</a> for our meta build system generator. Premake generates for us the actual build scripts that we then build with <code>tmbuild</code> our one-click build tool. More on tmbuild <a href="./tmbuild.html">here</a>.</p>
<p><strong>Table of Content</strong></p>
<ul>
<li><a href="#why-use-a-build-configurator">Why Use a Build Configurator?</a></li>
<li><a href="#what-is-premake">What is premake</a></li>
<li><a href="#the-basic-the-machinery-premake-setup">The Basic The Machinery Premake Setup</a></li>
<li><a href="#advanced-premake5-adding-functions-to-make-our-live-easier">Advanced Premake5: Adding functions to make our live easier</a></li>
<li><a href="#the-machinery-project-recommendation">The Machinery Project Recommendation</a></li>
<li><a href="#basic-premake5-cheat-sheet">Basic Premake5 Cheat Sheet</a></li>
</ul>
<h2 id="why-use-a-build-configurator"><a class="header" href="#why-use-a-build-configurator">Why Use a Build Configurator?</a></h2>
<p>Maintaining different <em>Makefiles</em> and <em>Visual Studio Solution</em> files for a cross platform project can be a lot of work. Especially since you have to adjust the generator a lot for every new platform you support.</p>
<ul>
<li>Writing <a href="https://www.cs.swarthmore.edu/%7Enewhall/unixhelp/howto_makefiles.html">Makefiles</a> even for the simplest projects can be a tedious effort without automation, and it is difficult to debug.</li>
<li>Visual Studio Solution and Project Files are pre-generated, but are not designed to be easy to edit by hand, so resolving merge conflicts with them can be frustrating.</li>
</ul>
<p>Several build tools exist that allow us to avoid these issues. <a href="https://cmake.org/">CMake</a> is widely used, but tends to have a high learning curve and its scripting language is not the easiest to learn. Moreover it can very hard to debug.</p>
<blockquote>
<p><strong>Source:</strong> This information is based on <a href="http://blog.johannesmp.com/2016/10/29/getting-started-with-premake/">Getting Started With Premake by Johannes Peter</a></p>
</blockquote>
<h2 id="what-is-premake"><a class="header" href="#what-is-premake">What is premake</a></h2>
<p><a href="https://premake.github.io/">Premake5</a> is a Lightweight, Open-source, Lua-based alternative to CMake. As with CMake, Premake allows you to define the structure and contents of your project and then dynamically generate whatever build files (Makefiles, VS Solutions, Xcode Projects, etc) you need at the time.</p>
<p>At the core of Premake5 is a <strong>premake5.lua</strong> file that describes your project (what programming language it uses, where to find source files, what dependencies it has, etc.). ‘<strong>premake5.lua</strong>’ is to <em><strong>Premake</strong></em> what is ‘<strong>Makefile</strong>’ is to <em><a href="https://www.gnu.org/software/make/">GNU Make</a></em> or a project/sln file to Visual Studios.</p>
<p>Because <em>premake5.lua</em> allows you to uniquely generate whatever build files you need in seconds, you no longer need to version them in your repository. You configure your version control to <a href="https://git-scm.com/docs/gitignore">ignore</a> the build files, and version the premake5.lua file instead. Resolving merge conflicts on a premake5.lua file is far more sane than on a Visual Studio project file.</p>
<p>Once you have a premake5.lua file, you can run the premake executable to generate your desired project files. For example:</p>
<ul>
<li>To generate a Makefile on Linux you run <code>./premake5 vs20122</code></li>
<li>To generate a VS 2022 Solution on Windows you run <code>premake5 vs2022</code></li>
</ul>
<blockquote>
<p><strong>Source:</strong> This information is based on <a href="http://blog.johannesmp.com/2016/10/29/getting-started-with-premake/">Getting Started With Premake by Johannes Peter</a></p>
</blockquote>
<h2 id="the-basic-the-machinery-premake-setup"><a class="header" href="#the-basic-the-machinery-premake-setup">The Basic The Machinery Premake Setup</a></h2>
<p>Since Premake is lua based you can make use of Lua's features. In this case we show a simple premake file for a plugin:</p>
<pre><code class="language-lua">-- premake5.lua
-- version: premake-5.0.0-alpha14

function snake_case(name)
    return string.gsub(name, &quot;-&quot;, &quot;_&quot;)
end

-- Include all project files from specified folder
function folder(t)
    if type(t) ~= &quot;table&quot; then t = {t} end
    for _,f in ipairs(t) do
        files {f .. &quot;/**.h&quot;,  f .. &quot;/**.c&quot;, f .. &quot;/**.inl&quot;, f .. &quot;/**.cpp&quot;, f .. &quot;/**.m&quot;, f .. &quot;/**.tmsl&quot;}
    end
end

function check_env(env)
    local env_var = os.getenv(env)

    if env_var == nil then
        return false
    end
    return true
end

function tm_lib_dir(path)
    local lib_dir = os.getenv(&quot;TM_LIB_DIR&quot;)

    if not check_env(&quot;TM_LIB_DIR&quot;) then
        error(&quot;TM_LIB_DIR not set&quot;)
        return nil
    end

    return lib_dir .. &quot;/&quot; .. path
end

oldlibdirs = libdirs
function libdirs(path)
    if not check_env(&quot;TM_SDK_DIR&quot;) then
        error(&quot;TM_SDK_DIR not set&quot;)
        return
    end
    sdk_dir = os.getenv(&quot;TM_SDK_DIR&quot;)
    oldlibdirs { 
        sdk_dir .. &quot;/lib/&quot; .. _ACTION .. &quot;/%{cfg.buildcfg}&quot;,
        sdk_dir .. &quot;/bin/%{cfg.buildcfg}&quot;,
        dirs
    }
    oldlibdirs { 
        sdk_dir .. &quot;/lib/&quot; .. _ACTION .. &quot;/%{cfg.buildcfg}&quot;,
        sdk_dir .. &quot;/bin/%{cfg.buildcfg}&quot;,
        dirs
    }
end

-- Make incluedirs() also call sysincludedirs()
oldincludedirs = includedirs
function includedirs(dirs)
    if not check_env(&quot;TM_SDK_DIR&quot;) then
        error(&quot;TM_SDK_DIR not set&quot;)
        return
    end
    sdk_dir = os.getenv(&quot;TM_SDK_DIR&quot;)
    oldincludedirs { 
        sdk_dir .. &quot;/headers&quot;,
        sdk_dir ,
         dirs
    }
    sysincludedirs { 
        sdk_dir .. &quot;/headers&quot;,
        sdk_dir ,
        dirs
    }
end
-- Makes sure the debugger points to the machinery
function set_debugger_to_engine()
    local sdk_dir = os.getenv(&quot;TM_SDK_DIR&quot;)
    if not check_env(&quot;TM_SDK_DIR&quot;) then
        error(&quot;TM_SDK_DIR not set&quot;)
        return
    end
    local debug_path_source = &quot;&quot;
    local debug_path_binary = &quot;&quot;
    if os.target() == &quot;windows&quot; then
         debug_path_source = &quot;/bin/Debug/the-machinery.exe&quot;
         debug_path_binary = &quot;/bin/the-machinery.exe&quot;
    else
         debug_path_source = &quot;/bin/Debug/the-machinery&quot;
         debug_path_binary = &quot;/bin/the-machinery&quot;
    end
    if os.isfile(sdk_dir..&quot;&quot;..debug_path_source) then
        debugcommand(sdk_dir..debug_path_source)
    elseif os.isfile(sdk_dir..&quot;&quot;..debug_path_binary) then
        debugcommand(sdk_dir..debug_path_binary)
    else
        error(&quot;Could not find '&quot;..sdk_dir..&quot;&quot;..debug_path_binary..&quot;' nor '&quot;..sdk_dir..&quot;&quot;..debug_path_source..&quot;'\nSuggestion: Please make sure the TM_SDK_DIR enviroment variable is pointing to the correct folder.&quot;)
    end
end


newoption {
    trigger     = &quot;clang&quot;,
    description = &quot;Force use of CLANG for Windows builds&quot;
}

workspace &quot;test-plugin&quot;
    configurations {&quot;Debug&quot;, &quot;Release&quot;}
    language &quot;C++&quot;
    cppdialect &quot;C++11&quot;
    flags { &quot;FatalWarnings&quot;, &quot;MultiProcessorCompile&quot; }
    warnings &quot;Extra&quot;
    inlining &quot;Auto&quot;
    sysincludedirs { &quot;&quot; }
    targetdir &quot;bin/%{cfg.buildcfg}&quot;

filter &quot;system:windows&quot;
    platforms { &quot;Win64&quot; }
    systemversion(&quot;latest&quot;)

filter {&quot;system:linux&quot;}
    platforms { &quot;Linux&quot; }

filter { &quot;system:windows&quot;, &quot;options:clang&quot; }
    toolset(&quot;msc-clangcl&quot;)
    buildoptions {
        &quot;-Wno-missing-field-initializers&quot;,   -- = {0} is OK.
        &quot;-Wno-unused-parameter&quot;,             -- Useful for documentation purposes.
        &quot;-Wno-unused-local-typedef&quot;,         -- We don't always use all typedefs.
        &quot;-Wno-missing-braces&quot;,               -- = {0} is OK.
        &quot;-Wno-microsoft-anon-tag&quot;,           -- Allow anonymous structs.
    }
    buildoptions {
        &quot;-fms-extensions&quot;,                   -- Allow anonymous struct as C inheritance.
        &quot;-mavx&quot;,                             -- AVX.
        &quot;-mfma&quot;,                             -- FMA.
    }
    removeflags {&quot;FatalLinkWarnings&quot;}        -- clang linker doesn't understand /WX

filter &quot;platforms:Win64&quot;
    defines { &quot;TM_OS_WINDOWS&quot;, &quot;_CRT_SECURE_NO_WARNINGS&quot; }
    includedirs { }
    staticruntime &quot;On&quot;
    architecture &quot;x64&quot;
    libdirs { }
    disablewarnings {
        &quot;4057&quot;, -- Slightly different base types. Converting from type with volatile to without.
        &quot;4100&quot;, -- Unused formal parameter. I think unusued parameters are good for documentation.
        &quot;4152&quot;, -- Conversion from function pointer to void *. Should be ok.
        &quot;4200&quot;, -- Zero-sized array. Valid C99.
        &quot;4201&quot;, -- Nameless struct/union. Valid C11.
        &quot;4204&quot;, -- Non-constant aggregate initializer. Valid C99.
        &quot;4206&quot;, -- Translation unit is empty. Might be #ifdefed out.
        &quot;4214&quot;, -- Bool bit-fields. Valid C99.
        &quot;4221&quot;, -- Pointers to locals in initializers. Valid C99.
        &quot;4702&quot;, -- Unreachable code. We sometimes want return after exit() because otherwise we get an error about no return value.
    }
    linkoptions {&quot;/ignore:4099&quot;}
    buildoptions {&quot;/utf-8&quot;}     

filter {&quot;platforms:Linux&quot;}
    defines { &quot;TM_OS_LINUX&quot;, &quot;TM_OS_POSIX&quot; }
    includedirs { }
    architecture &quot;x64&quot;
    toolset &quot;clang&quot;
    buildoptions {
        &quot;-fms-extensions&quot;,                   -- Allow anonymous struct as C inheritance.
        &quot;-g&quot;,                                -- Debugging.
        &quot;-mavx&quot;,                             -- AVX.
        &quot;-mfma&quot;,                             -- FMA.
        &quot;-fcommon&quot;,                          -- Allow tentative definitions
    }
    libdirs { }
    disablewarnings {
        &quot;missing-field-initializers&quot;,   -- = {0} is OK.
        &quot;unused-parameter&quot;,             -- Useful for documentation purposes.
        &quot;unused-local-typedef&quot;,         -- We don't always use all typedefs.
        &quot;missing-braces&quot;,               -- = {0} is OK.
        &quot;microsoft-anon-tag&quot;,           -- Allow anonymous structs.
    }
    removeflags {&quot;FatalWarnings&quot;}

filter &quot;configurations:Debug&quot;
    defines { &quot;TM_CONFIGURATION_DEBUG&quot;, &quot;DEBUG&quot; }
    symbols &quot;On&quot;
    filter &quot;system:windows&quot;
        set_debugger_to_engine() -- sets the debugger in VS Studio to point to the_machinery.exe

filter &quot;configurations:Release&quot;
    defines { &quot;TM_CONFIGURATION_RELEASE&quot; }
    optimize &quot;On&quot;

project &quot;test-plugin&quot;
    location &quot;build/test-plugin&quot;
    targetname &quot;test-plugin&quot;
    kind &quot;SharedLib&quot;
    language &quot;C++&quot;
    files {&quot;*.inl&quot;, &quot;*.h&quot;, &quot;*.c&quot;}
</code></pre>
<p>Wow this is a lot of code ... lets talk about the basics: <code>filter </code>, <code>workspace</code> and <code>project</code></p>
<p><code>filter {...}</code> allows you to set a filter for a specific configuiration or option.  For example:</p>
<pre><code class="language-lua">filter &quot;configurations:Debug&quot;
    defines { &quot;TM_CONFIGURATION_DEBUG&quot;, &quot;DEBUG&quot; }
    symbols &quot;On&quot;
    filter &quot;system:windows&quot;
        set_debugger_to_engine() -- sets the debugger in VS Studio to point to the_machinery.exe

filter &quot;configurations:Release&quot;
    defines { &quot;TM_CONFIGURATION_RELEASE&quot; }
    optimize &quot;On&quot;
</code></pre>
<p>This example tells Premake5 that on Debug we have the define <a href="https://ourmachinery.com/apidoc/foundation/api_types.h.html#tm_configuration_debug"><code>TM_CONFIGURATION_DEBUG</code></a> and we generate debug symbols : <code>symbols &quot;On&quot;</code> and only on windows we make sure that we point to the right debugger:</p>
<pre><code class="language-lua">    filter &quot;system:windows&quot;
        set_debugger_to_engine() -- sets the debugger in VS Studio to point to the_machinery.exe
</code></pre>
<p>With this knowlege we still have not reduced the amount of code to think about! Yes that is right so lets just say: We can ignore 90% of the premake file and just take it as it is and only focus on the really important aspects:</p>
<pre><code class="language-lua">--- more code we can ignore
workspace &quot;test-plugin&quot;
    configurations {&quot;Debug&quot;, &quot;Release&quot;}
    language &quot;C++&quot;
    cppdialect &quot;C++11&quot;
    flags { &quot;FatalWarnings&quot;, &quot;MultiProcessorCompile&quot; }
    warnings &quot;Extra&quot;
    inlining &quot;Auto&quot;
    sysincludedirs { &quot;&quot; }
    targetdir &quot;bin/%{cfg.buildcfg}&quot;
--- more code we can ignore
project &quot;test-plugin&quot;
    location &quot;build/test-plugin&quot;
    targetname &quot;test-plugin&quot;
    kind &quot;SharedLib&quot;
    language &quot;C++&quot;
    files {&quot;*.inl&quot;, &quot;*.h&quot;, &quot;*.c&quot;}
</code></pre>
<p>This defines our workspace. This woul be in VS our Solution:</p>
<pre><code class="language-lua">workspace &quot;test-plugin&quot; --- The name of the Workspace == The Solution name in VS
    configurations {&quot;Debug&quot;, &quot;Release&quot;} -- The configurations we offer
    language &quot;C++&quot; -- The Language in this case C++
    cppdialect &quot;C++11&quot; 
    flags { &quot;FatalWarnings&quot;, &quot;MultiProcessorCompile&quot; } -- We treat warnings as errors and can compile with more cores
    warnings &quot;Extra&quot; -- That we basically show all warnings
    inlining &quot;Auto&quot;
    sysincludedirs { &quot;&quot; } -- making sure we have the system includes
    targetdir &quot;bin/%{cfg.buildcfg}&quot; -- where do we store our binary files, not our .d files etc...
</code></pre>
<p>The next important aspect is the project itself:</p>
<pre><code class="language-lua">project &quot;test-plugin&quot; -- The name of the project in VS or the target in the Makefile
    location &quot;build/test-plugin&quot; -- Where do we want to store all our artifacts such as .d .obj etc
    targetname &quot;test-plugin&quot; -- The name of our executable, shared lib or static lib?
    kind &quot;SharedLib&quot; -- What kind? StaticLib, SharedLib, Executable?
    language &quot;C++&quot;-- What is our languge of implemntation? 
    files {&quot;*.inl&quot;, &quot;*.h&quot;, &quot;*.c&quot;} -- What files do we want to automagically include in our project?
</code></pre>
<p>If you want to add a new project to your premake file you can just add a new block such as the one above to to your premake file:</p>
<pre><code class="language-lua">project &quot;new-project&quot; 
    location &quot;build/new-project&quot; 
    targetname &quot;new-project&quot; 
    kind &quot;SharedLib&quot; 
    language &quot;C&quot;
	cppdialect &quot;C11&quot; -- you can also add other things here!
    files {&quot;*.inl&quot;, &quot;*.h&quot;, &quot;*.c&quot;} 
</code></pre>
<p>This adds a new project called <code>new-project</code> to your premake file when you compile now the dll with the name `<code>new-project</code>will be build on Windows on Linux it will be a<code>.so\</code> file.</p>
<h2 id="advanced-premake5-adding-functions-to-make-our-live-easier"><a class="header" href="#advanced-premake5-adding-functions-to-make-our-live-easier">Advanced Premake5: Adding functions to make our live easier</a></h2>
<p>The code example above is great but its quite a lot of work. This is something you can change. Since Premake5 is using Lua you can just write functions to bundle your code together. For example lets say we want a base for all our projects:</p>
<pre><code class="language-lua">function base(name)
    project(name)
        language &quot;C++&quot;
        includedirs { &quot;&quot; }
end
</code></pre>
<p>And than we want to make sure that our plugins (.dlls) are all the same but easy to use:</p>
<pre><code class="language-lua">function plugin(name)
    local sn = snake_case(name) -- function that converts a name to snake case
    base(name)
        location(&quot;build/plugins/&quot; .. sn)
        kind &quot;SharedLib&quot;
        targetdir &quot;bin/%{cfg.buildcfg}/plugins&quot;
        targetname(&quot;tm_&quot; .. sn)
        defines {&quot;TM_LINKS_&quot; .. string.upper(sn)}
        dependson(&quot;foundation&quot;)
        folder {&quot;plugins/&quot; .. sn}
        language &quot;C++&quot;
        includedirs { &quot;&quot; } -- A override (see above) that makes sure we have the right include dir also with the SDK dirs
end
</code></pre>
<p>This allows us to re-write our example from above:</p>
<pre><code class="language-lua">plugin(&quot;test-plugin&quot;)
plugin(&quot;new-project&quot;)
</code></pre>
<p>Moreover we need a utility tool? No problem we can just write a function for this:</p>
<pre><code class="language-lua">-- Project type for utility programs
function util(name)
    local sn = snake_case(name)
    base(name)
        location(&quot;build/&quot; .. sn)
        kind &quot;ConsoleApp&quot;
        targetdir &quot;bin/%{cfg.buildcfg}&quot;
        defines { &quot;TM_LINKS_FOUNDATION&quot; }
        dependson { &quot;foundation&quot; }
        links { &quot;foundation&quot; }
        folder {&quot;utils/&quot; .. sn}
        filter { &quot;platforms:Linux&quot; }
            linkoptions {&quot;-ldl&quot;, &quot;-lanl&quot;, &quot;-pthread&quot;}
        filter {} -- clear filter for future calls
end
</code></pre>
<p>This allows for the following lines of code:</p>
<pre><code class="language-lua">plugin(&quot;test-plugin&quot;)
plugin(&quot;new-project&quot;)
util(&quot;my-untility&quot;)
</code></pre>
<h2 id="the-machinery-project-recommendation"><a class="header" href="#the-machinery-project-recommendation">The Machinery Project Recommendation</a></h2>
<p>We recommend you to make use of one single premake file that manages all your plugins at one build. This avoids the need to go in each of the folder to build your project. As recommended in the the chapter <a href="https://ourmachinery.github.io/themachinery-books//getting_started/project_setup.html#possible-folder-structure-for-a-project">Project Setup: Possible folder structure for a project</a> we recommend also to seperate your plugins into sub folders. The following image shows a potential setup for your game plugins:</p>
<p><img src="https://www.dropbox.com/s/l1429g7p5xx8kj2/tm_guide_possible_subfolder.png?raw=1" alt="" /></p>
<p>In here we have one single <code>premake</code> file and a single <code>libs.json</code> as well as the <code>libs</code> folder. This allows you to run <code>tmbuild</code> just in this folder and all plugins or the ones you want to build can be built at once. </p>
<p>In this case the premake file could look like this:</p>
<blockquote>
<p><strong>TODO</strong> move this to code snippets!</p>
</blockquote>
<pre><code class="language-lua">-- premake5.lua
-- version: premake-5.0.0-alpha14

function snake_case(name)
    return string.gsub(name, &quot;-&quot;, &quot;_&quot;)
end

-- Include all project files from specified folder
function folder(t)
    if type(t) ~= &quot;table&quot; then t = {t} end
    for _,f in ipairs(t) do
        files {f .. &quot;/**.h&quot;,  f .. &quot;/**.c&quot;, f .. &quot;/**.inl&quot;, f .. &quot;/**.cpp&quot;, f .. &quot;/**.m&quot;, f .. &quot;/**.tmsl&quot;}
    end
end

function check_env(env)
    local env_var = os.getenv(env)

    if env_var == nil then
        return false
    end
    return true
end

function tm_lib_dir(path)
    local lib_dir = os.getenv(&quot;TM_LIB_DIR&quot;)

    if not check_env(&quot;TM_LIB_DIR&quot;) then
        error(&quot;TM_LIB_DIR not set&quot;)
        return nil
    end

    return lib_dir .. &quot;/&quot; .. path
end

oldlibdirs = libdirs
function libdirs(path)
    if not check_env(&quot;TM_SDK_DIR&quot;) then
        error(&quot;TM_SDK_DIR not set&quot;)
        return
    end
    sdk_dir = os.getenv(&quot;TM_SDK_DIR&quot;)
    oldlibdirs { 
        sdk_dir .. &quot;/lib/&quot; .. _ACTION .. &quot;/%{cfg.buildcfg}&quot;,
        sdk_dir .. &quot;/bin/%{cfg.buildcfg}&quot;,
        dirs
    }
    oldlibdirs { 
        sdk_dir .. &quot;/lib/&quot; .. _ACTION .. &quot;/%{cfg.buildcfg}&quot;,
        sdk_dir .. &quot;/bin/%{cfg.buildcfg}&quot;,
        dirs
    }
end

-- Make incluedirs() also call sysincludedirs()
oldincludedirs = includedirs
function includedirs(dirs)
    if not check_env(&quot;TM_SDK_DIR&quot;) then
        error(&quot;TM_SDK_DIR not set&quot;)
        return
    end
    sdk_dir = os.getenv(&quot;TM_SDK_DIR&quot;)
    oldincludedirs { 
        sdk_dir .. &quot;/headers&quot;,
        sdk_dir ,
         dirs
    }
    sysincludedirs { 
        sdk_dir .. &quot;/headers&quot;,
        sdk_dir ,
        dirs
    }
end
-- Makes sure the debugger points to the machinery
function set_debugger_to_engine()
    local sdk_dir = os.getenv(&quot;TM_SDK_DIR&quot;)
    if not check_env(&quot;TM_SDK_DIR&quot;) then
        error(&quot;TM_SDK_DIR not set&quot;)
        return
    end
    local debug_path_source = &quot;&quot;
    local debug_path_binary = &quot;&quot;
    if os.target() == &quot;windows&quot; then
         debug_path_source = &quot;/bin/Debug/the-machinery.exe&quot;
         debug_path_binary = &quot;/bin/the-machinery.exe&quot;
    else
         debug_path_source = &quot;/bin/Debug/the-machinery&quot;
         debug_path_binary = &quot;/bin/the-machinery&quot;
    end
    if os.isfile(sdk_dir..&quot;&quot;..debug_path_source) then
        debugcommand(sdk_dir..debug_path_source)
    elseif os.isfile(sdk_dir..&quot;&quot;..debug_path_binary) then
        debugcommand(sdk_dir..debug_path_binary)
    else
        error(&quot;Could not find '&quot;..sdk_dir..&quot;&quot;..debug_path_binary..&quot;' nor '&quot;..sdk_dir..&quot;&quot;..debug_path_source..&quot;'\nSuggestion: Please make sure the TM_SDK_DIR enviroment variable is pointing to the correct folder.&quot;)
    end
end


newoption {
    trigger     = &quot;clang&quot;,
    description = &quot;Force use of CLANG for Windows builds&quot;
}

workspace &quot;test-plugin&quot;
    configurations {&quot;Debug&quot;, &quot;Release&quot;}
    language &quot;C++&quot;
    cppdialect &quot;C++11&quot;
    flags { &quot;FatalWarnings&quot;, &quot;MultiProcessorCompile&quot; }
    warnings &quot;Extra&quot;
    inlining &quot;Auto&quot;
    sysincludedirs { &quot;&quot; }
    targetdir &quot;bin/%{cfg.buildcfg}&quot;

filter &quot;system:windows&quot;
    platforms { &quot;Win64&quot; }
    systemversion(&quot;latest&quot;)

filter {&quot;system:linux&quot;}
    platforms { &quot;Linux&quot; }

filter { &quot;system:windows&quot;, &quot;options:clang&quot; }
    toolset(&quot;msc-clangcl&quot;)
    buildoptions {
        &quot;-Wno-missing-field-initializers&quot;,   -- = {0} is OK.
        &quot;-Wno-unused-parameter&quot;,             -- Useful for documentation purposes.
        &quot;-Wno-unused-local-typedef&quot;,         -- We don't always use all typedefs.
        &quot;-Wno-missing-braces&quot;,               -- = {0} is OK.
        &quot;-Wno-microsoft-anon-tag&quot;,           -- Allow anonymous structs.
    }
    buildoptions {
        &quot;-fms-extensions&quot;,                   -- Allow anonymous struct as C inheritance.
        &quot;-mavx&quot;,                             -- AVX.
        &quot;-mfma&quot;,                             -- FMA.
    }
    removeflags {&quot;FatalLinkWarnings&quot;}        -- clang linker doesn't understand /WX

filter &quot;platforms:Win64&quot;
    defines { &quot;TM_OS_WINDOWS&quot;, &quot;_CRT_SECURE_NO_WARNINGS&quot; }
    includedirs { }
    staticruntime &quot;On&quot;
    architecture &quot;x64&quot;
    libdirs { }
    disablewarnings {
        &quot;4057&quot;, -- Slightly different base types. Converting from type with volatile to without.
        &quot;4100&quot;, -- Unused formal parameter. I think unusued parameters are good for documentation.
        &quot;4152&quot;, -- Conversion from function pointer to void *. Should be ok.
        &quot;4200&quot;, -- Zero-sized array. Valid C99.
        &quot;4201&quot;, -- Nameless struct/union. Valid C11.
        &quot;4204&quot;, -- Non-constant aggregate initializer. Valid C99.
        &quot;4206&quot;, -- Translation unit is empty. Might be #ifdefed out.
        &quot;4214&quot;, -- Bool bit-fields. Valid C99.
        &quot;4221&quot;, -- Pointers to locals in initializers. Valid C99.
        &quot;4702&quot;, -- Unreachable code. We sometimes want return after exit() because otherwise we get an error about no return value.
    }
    linkoptions {&quot;/ignore:4099&quot;}
    buildoptions {&quot;/utf-8&quot;}     

filter {&quot;platforms:Linux&quot;}
    defines { &quot;TM_OS_LINUX&quot;, &quot;TM_OS_POSIX&quot; }
    includedirs { }
    architecture &quot;x64&quot;
    toolset &quot;clang&quot;
    buildoptions {
        &quot;-fms-extensions&quot;,                   -- Allow anonymous struct as C inheritance.
        &quot;-g&quot;,                                -- Debugging.
        &quot;-mavx&quot;,                             -- AVX.
        &quot;-mfma&quot;,                             -- FMA.
        &quot;-fcommon&quot;,                          -- Allow tentative definitions
    }
    libdirs { }
    disablewarnings {
        &quot;missing-field-initializers&quot;,   -- = {0} is OK.
        &quot;unused-parameter&quot;,             -- Useful for documentation purposes.
        &quot;unused-local-typedef&quot;,         -- We don't always use all typedefs.
        &quot;missing-braces&quot;,               -- = {0} is OK.
        &quot;microsoft-anon-tag&quot;,           -- Allow anonymous structs.
    }
    removeflags {&quot;FatalWarnings&quot;}

filter &quot;configurations:Debug&quot;
    defines { &quot;TM_CONFIGURATION_DEBUG&quot;, &quot;DEBUG&quot; }
    symbols &quot;On&quot;
    filter &quot;system:windows&quot;
        set_debugger_to_engine() -- sets the debugger in VS Studio to point to the_machinery.exe

filter &quot;configurations:Release&quot;
    defines { &quot;TM_CONFIGURATION_RELEASE&quot; }
    optimize &quot;On&quot;

function base(name)
    project(name)
        language &quot;C++&quot;
        includedirs { &quot;&quot; }
end

function plugin(name)
    local sn = snake_case(name) -- function that converts a name to snake case
    base(name)
        location(&quot;build/plugins/&quot; .. sn)
        kind &quot;SharedLib&quot;
        targetdir &quot;bin/%{cfg.buildcfg}/plugins&quot;
        targetname(&quot;tm_&quot; .. sn)
        defines {&quot;TM_LINKS_&quot; .. string.upper(sn)}
        dependson(&quot;foundation&quot;)
        folder {&quot;plugins/&quot; .. sn}
        language &quot;C++&quot;
        includedirs { &quot;&quot; } -- A override (see above) that makes sure we have the right include dir also with the SDK dirs
end

plugin(&quot;plugin-a&quot;)
plugin(&quot;plugin-b&quot;)
</code></pre>
<h2 id="basic-premake5-cheat-sheet"><a class="header" href="#basic-premake5-cheat-sheet">Basic Premake5 Cheat Sheet</a></h2>
<table><thead><tr><th>Command</th><th>Documentation</th></tr></thead><tbody>
<tr><td><a href="https://premake.github.io/docs/Filters/"><code>filter</code></a></td><td>Can be used similar to a if to configure your build configuration only in certain cases.</td></tr>
<tr><td><code>filter &quot;system:windows&quot;</code>, <code>filter &quot;system:Linux&quot;</code> <code>filter &quot;system:web&quot;</code></td><td>Filters below this only apply if the system is one of the give platforms.</td></tr>
<tr><td><code>filter &quot;configurations:Release&quot;</code>, <code>filter &quot;configurations:Debug&quot;</code></td><td>The filter only apply if the configuration is Debug/Release.</td></tr>
<tr><td><code>filter { &quot;system:windows&quot;, &quot;options:clang&quot; }</code></td><td>Any filter below this only apply if the msvc-clang tool chain is used.</td></tr>
<tr><td><a href="https://premake.github.io/docs/language/"><code>language</code></a></td><td>Sets the Programming Language. e.g. <code>language (&quot;C&quot;)</code> or <code>language (&quot;C++&quot;)</code></td></tr>
<tr><td><a href="https://premake.github.io/docs/dependson/"><code>dependson</code></a></td><td>Specify one or more non-linking project build order dependencies.</td></tr>
<tr><td><a href="https://premake.github.io/docs/targetname/"><code>targetname</code></a></td><td>Specifies the base file name for the compiled binary target.</td></tr>
<tr><td><a href="https://premake.github.io/docs/defines/"><code>defines</code></a></td><td>Adds preprocessor or compiler symbols to a project.</td></tr>
<tr><td><a href="https://premake.github.io/docs/location/"><code>location</code></a></td><td>Sets the destination directory for a generated workspace or project file.</td></tr>
<tr><td><a href="https://premake.github.io/docs/kind/"><code>kind</code></a></td><td>Sets the kind of binary object being created by the project or configuration, such as a console or windowed application, or a shared or static library. e.g. <code>ConsoleApp</code>, <code>WindowedApp</code>, <code>SharedLib</code>, <code>StaticLib</code></td></tr>
<tr><td><a href="https://premake.github.io/docs/targetdir/"><code>targetdir</code></a></td><td>Sets the destination directory for the compiled binary target.</td></tr>
<tr><td><a href="https://premake.github.io/docs/optimize/"><code>optimize</code></a></td><td>The <strong>optimize</strong> function specifies the level and type of optimization used while building the target configuration.</td></tr>
<tr><td><a href="https://premake.github.io/docs/symbols/"><code>symbols</code></a></td><td>Turn on/off debug symbol table generation.</td></tr>
<tr><td><a href="https://premake.github.io/docs/toolset/"><code>toolset</code></a></td><td>Selects the compiler, linker, etc. which are used to build a project or configuration.</td></tr>
<tr><td><a href="https://premake.github.io/docs/buildoptions/"><code>buildoptions</code></a></td><td>Passes arguments directly to the compiler command line without translation.</td></tr>
<tr><td><a href="https://premake.github.io/docs/architecture/"><code>architecture</code></a></td><td>Specifies the system architecture to be targeted by the configuration.</td></tr>
<tr><td><a href="https://premake.github.io/docs/disablewarnings/"><code>disablewarnings</code></a></td><td>Disables specific compiler warnings.</td></tr>
<tr><td><a href="https://premake.github.io/docs/Removing-Values/"><code>removeflags</code></a></td><td>The remove...() set of functions remove one or more values from a list of configuration values. Every configuration list in the Premake API has a corresponding remove function: <a href="https://premake.github.io/docs/flags">flags()</a> has removeflags(), <a href="https://premake.github.io/docs/defines">defines()</a> has removedefines(), and so on.</td></tr>
<tr><td><a href="https://premake.github.io/docs/staticruntime/"><code>staticruntime</code></a></td><td>Select the staticruntime</td></tr>
<tr><td><a href="https://premake.github.io/docs/linkoptions/"><code>linkoptions</code></a></td><td>Passes arguments directly to the linker command line without translation.</td></tr>
<tr><td><a href="https://premake.github.io/docs/includedirs/"><code>includedirs</code></a></td><td>Specifies the include file search paths for the compiler. <strong>Note:</strong> We are using a modified version in our codebase (see Premake code above) that overrides the default behaviour by saving the original function code in <code>oldincludedirs</code>. In our implementation we make sure that the <code>TM_SDK_DIR</code> is correctly set.</td></tr>
<tr><td><a href="https://premake.github.io/docs/libdirs/"><code>libdirs</code></a></td><td>Specifies the library search paths for the linker. <strong>Note:</strong> We are using a modified version in our codebase (see Premake code above) that overrides the default behaviour by saving the original function code in <code>oldlibdirs</code>. In our implementation we make sure that the <code>TM_SDK_DIR</code> is correctly set.</td></tr>
<tr><td><a href="https://premake.github.io/docs/platforms/"><code>platforms</code></a></td><td>Specifies a set of build platforms, which act as another configuration axis when building.</td></tr>
<tr><td><a href="https://premake.github.io/docs/postbuildcommands/"><code>postbuildcommands </code></a></td><td>Specifies shell commands to run after build is finished.</td></tr>
<tr><td><a href="https://premake.github.io/docs/prebuildcommands"><code>prebuildcommands</code></a></td><td>Specifies shell commands to run before each build.</td></tr>
<tr><td><a href="https://premake.github.io/docs/Custom-Build-Commands/#pre--and-post-build-stages">Pre- and Post-Build Stages</a></td><td>These are the simplest to setup and use: pass one or more command lines to the <a href="https://premake.github.io/docs/prebuildcommands"><code>prebuildcommands</code></a>, <a href="https://premake.github.io/docs/prelinkcommands"><code>prelinkcommands</code></a>, or <a href="https://premake.github.io/docs/postbuildcommands"><code>postbuildcommands</code></a> functions. You can use <a href="https://premake.github.io/docs/Tokens">Tokens</a> to create generic commands that will work across platforms and configurations.</td></tr>
<tr><td><strong>Functions</strong></td><td>Documentation</td></tr>
<tr><td><code>os.getenv()</code></td><td>The <code>os.getenv</code> function gets the value of an environment variable. It receives the name of the variable and returns a string with its value. (https://www.lua.org/pil/22.2.html)</td></tr>
<tr><td><code>os.target()</code></td><td>Returns the name of the operating system currently being targeted.<br/>See <a href="https://premake.github.io/docs/system">system</a> for a complete list of OS identifiers.</td></tr>
</tbody></table>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../extending_the_machinery/application_hooks.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../build_tools/tmbuild.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../extending_the_machinery/application_hooks.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../build_tools/tmbuild.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
